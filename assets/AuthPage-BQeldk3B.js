import{c as Y,u as Z,r as l,j as e,B as o,t as i}from"./index-DmkZlZjy.js";import{C as b,L as N,A as J,a as _,b as c,I as d}from"./label-Zxuv03fs.js";import{u as ee}from"./useTranslation-DSe_g0-j.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],te=Y("circle-check",se);function le({onBack:v}){const{t:w,language:F}=ee(),t=w.auth,m=w.common,{signIn:L,signUp:R,verifyOTP:O,resendOTP:I,userType:g,setUserType:A}=Z(),[r,h]=l.useState(()=>sessionStorage.getItem("auth_redirect_mode")==="signup"?(sessionStorage.removeItem("auth_redirect_mode"),"signup"):"login"),[u,B]=l.useState(""),[E,M]=l.useState(""),[p,$]=l.useState(""),[k,K]=l.useState(""),[C,U]=l.useState(""),[S,z]=l.useState(""),[P,V]=l.useState(""),[D,G]=l.useState(""),[x,f]=l.useState(!1),[j,H]=l.useState(["","","","","","","",""]),y=l.useRef([]),Q=(s,a)=>{if(a.length>1&&(a=a.slice(-1)),!/^\d*$/.test(a))return;const n=[...j];n[s]=a,H(n),a&&s<7&&y.current[s+1]?.focus()},W=(s,a)=>{a.key==="Backspace"&&!j[s]&&s>0&&y.current[s-1]?.focus()},T=async s=>{s.preventDefault();const a=j.join("");if(a.length<8){i.error(t.otpRequired);return}f(!0);try{const{error:n}=await O(u,a,"signup");if(n)throw n;i.success(m.success)}catch(n){i.error(n.message||m.error)}finally{f(!1)}},X=async()=>{f(!0);try{const{error:s}=await I(u,"signup");if(s)throw s;i.success(t.accountCreated)}catch(s){i.error(s.message||m.error)}finally{f(!1)}},q=async s=>{if(s.preventDefault(),r==="verify")return T(s);f(!0);try{if(r==="login"){const{error:a}=await L(u,p);if(a){if(a.message.includes("Email not confirmed")){h("verify"),i.info(t.verificationTitle);return}throw a}i.success(t.loginSuccess)}else if(r==="signup"){if(!g){i.error(t.chooseRole);return}if(p!==k)throw new Error(t.passwordsNotMatch);const{error:a}=await R(u,p,{full_name:C,phone:E,mother_job:S,father_job:P,default_address:D});if(a)throw a;h("verify"),i.success(t.accountCreated)}else r==="forgot"&&(i.info("Feature coming soon"),h("login"))}catch(a){console.error(a),i.error(a.message||m.error)}finally{f(!1)}};return r==="verify"?e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-[#FFD1DA] to-[#FB5E7A]",children:e.jsxs(b,{className:"max-w-md w-full p-8 space-y-6",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-pink-100 rounded-full flex items-center justify-center",children:e.jsx(te,{className:"w-6 h-6 text-[#FB5E7A]"})}),e.jsx("h2",{className:"text-[#FB5E7A] text-2xl font-bold",children:t.verificationTitle}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.verificationDesc.replace("{email}",u)})]}),e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center gap-1 sm:gap-3",dir:"ltr",children:j.map((s,a)=>e.jsx("input",{ref:n=>{y.current[a]=n},type:"text",maxLength:1,value:s,onChange:n=>Q(a,n.target.value),onKeyDown:n=>W(a,n),className:"w-8 h-10 sm:w-12 sm:h-14 text-center text-lg sm:text-2xl font-bold border-2 border-[#FB5E7A] rounded-lg focus:ring-2 focus:ring-[#FB5E7A] focus:outline-none bg-white dark:bg-gray-800"},a))}),e.jsx(o,{type:"submit",disabled:x,className:"w-full bg-[#FB5E7A] hover:bg-[#e5536e] h-12 text-lg",children:x?e.jsx(N,{className:"w-5 h-5 animate-spin"}):t.verifyButton}),e.jsx("div",{className:"text-center",children:e.jsx(o,{type:"button",variant:"link",className:"text-[#FB5E7A]",onClick:X,disabled:x,children:t.resendOtp})}),e.jsx(o,{type:"button",variant:"ghost",className:"w-full text-gray-500",onClick:()=>h("signup"),children:m.back})]})]})}):r==="forgot"?e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-[#FFD1DA] to-[#FB5E7A]",children:e.jsxs(b,{className:"max-w-md w-full p-8 space-y-6",children:[e.jsxs(o,{variant:"ghost",onClick:()=>h("login"),className:"text-[#FB5E7A]",children:[F==="ar"?e.jsx(J,{className:"w-4 h-4 ml-2"}):e.jsx(_,{className:"w-4 h-4 mr-2"}),m.back]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-[#FB5E7A] text-xl font-bold",children:t.resetPassword}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.resetDescription})]}),e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"reset-email",children:t.email}),e.jsx(d,{id:"reset-email",type:"email",value:u,onChange:s=>B(s.target.value),required:!0,className:"border-[#FB5E7A]"})]}),e.jsx(o,{type:"submit",disabled:x,className:"w-full bg-[#FB5E7A] hover:bg-[#e5536e]",children:x?e.jsx(N,{className:"w-4 h-4 animate-spin"}):t.sendReset}),e.jsx(o,{type:"button",variant:"link",className:"w-full text-[#FB5E7A]",onClick:()=>h("login"),children:t.backToLogin})]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-[#FFD1DA] to-[#FB5E7A]",children:e.jsxs(b,{className:"max-w-md w-full p-8 space-y-6",children:[v&&e.jsxs(o,{variant:"ghost",onClick:v,className:"text-[#FB5E7A]",children:[F==="ar"?e.jsx(J,{className:"w-4 h-4 ml-2"}):e.jsx(_,{className:"w-4 h-4 mr-2"}),m.back]}),r==="signup"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{className:"text-center block text-gray-700 dark:text-gray-300 mb-2",children:t.chooseRole}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(o,{type:"button",variant:g==="client"?"default":"outline",className:`h-auto py-3 px-2 flex flex-col gap-1 transition-all ${g==="client"?"bg-[#FB5E7A] hover:bg-[#e5536e] text-white shadow-md":"border-[#FB5E7A] text-[#FB5E7A] hover:bg-pink-50"}`,onClick:()=>A("client"),children:e.jsx("span",{className:"font-bold text-sm",children:t.roleClient})}),e.jsx(o,{type:"button",variant:g==="sitter"?"default":"outline",className:`h-auto py-3 px-2 flex flex-col gap-1 transition-all ${g==="sitter"?"bg-[#FB5E7A] hover:bg-[#e5536e] text-white shadow-md":"border-[#FB5E7A] text-[#FB5E7A] hover:bg-pink-50"}`,onClick:()=>A("sitter"),children:e.jsx("span",{className:"font-bold text-sm",children:t.roleSitter})})]})]}),e.jsx("h2",{className:"text-center text-2xl font-bold text-[#FB5E7A]",children:r==="login"?t.login:t.signup}),e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[r==="signup"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"fullName",children:t.fullName}),e.jsx(d,{id:"fullName",type:"text",value:C,onChange:s=>U(s.target.value),required:!0,className:"border-[#FB5E7A]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"email",children:t.emailOrPhone}),e.jsx(d,{id:"email",type:"email",value:u,onChange:s=>B(s.target.value),required:!0,className:"border-[#FB5E7A]"})]}),r==="signup"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"phone",children:t.phone}),e.jsx(d,{id:"phone",type:"tel",value:E,onChange:s=>M(s.target.value),required:!0,className:"border-[#FB5E7A]"})]}),g==="client"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"motherJob",children:t.motherJob}),e.jsx(d,{id:"motherJob",type:"text",value:S,onChange:s=>z(s.target.value),required:!0,className:"border-[#FB5E7A]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"fatherJob",children:t.fatherJob}),e.jsx(d,{id:"fatherJob",type:"text",value:P,onChange:s=>V(s.target.value),required:!0,className:"border-[#FB5E7A]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"defaultAddress",children:t.defaultAddress}),e.jsx(d,{id:"defaultAddress",type:"text",value:D,onChange:s=>G(s.target.value),required:!0,className:"border-[#FB5E7A]",placeholder:t.addressPlaceholder})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"password",children:t.password}),e.jsx(d,{id:"password",type:"password",value:p,onChange:s=>$(s.target.value),required:!0,className:"border-[#FB5E7A]"})]}),r==="signup"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"confirmPassword",children:t.confirmPassword}),e.jsx(d,{id:"confirmPassword",type:"password",value:k,onChange:s=>K(s.target.value),required:!0,className:"border-[#FB5E7A]"})]}),r==="login"&&e.jsx(o,{type:"button",variant:"link",className:"text-[#FB5E7A] p-0 h-auto",onClick:()=>h("forgot"),children:t.forgotPassword}),e.jsx(o,{type:"submit",disabled:x,className:"w-full bg-[#FB5E7A] hover:bg-[#e5536e]",children:x?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4 animate-spin"}),m.loading]}):r==="login"?t.loginButton:t.signupButton})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r==="login"?t.noAccount:t.haveAccount," "]}),e.jsx(o,{variant:"link",className:"text-[#FB5E7A] p-0 h-auto",onClick:()=>h(r==="login"?"signup":"login"),children:r==="login"?t.switchToSignup:t.switchToLogin})]})]})})}export{le as default};
