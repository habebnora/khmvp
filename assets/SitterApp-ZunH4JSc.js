import{c as ce,u as ae,r as b,t as T,j as e,B as P,s as Q,g as cs}from"./index-DmkZlZjy.js";import{A as Se,a as ke,C as z,b as H,I as J,L as ee}from"./label-Zxuv03fs.js";import{s as U,n as Qt,q as Fe,$ as Pe,_ as $,o as ne,a6 as be,p as we,B as V,T as Ae,j as ie,A as ye,C as Be,i as je,S as ze,a0 as Te,a1 as $t,x as se,K as ht,a2 as He,M as Ue,y as Ne,z as os,E as ds,F as ve,G as us,h as xt,D as Re,k as _e,l as qe,m as Le,J as Ce,L as ms,N as hs,O as gs,Q as xs,U as Xt,V as fs,Y as ps,a5 as Zt,a4 as es,Z as ts,W as ys,r as Ve,t as jt,v as fe,w as me,ab as js,a8 as Nt,a3 as Ns,a7 as vs,a9 as bs,aa as ws,X as Ss,H as ks}from"./location-CSCqXxbz.js";import{C as Ie,a as Cs,D as ft,r as Es}from"./review-CmHXGQ_Z.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],vt=ce("activity",As);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Ds=ce("calendar-days",Bs);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],_s=ce("download",Rs);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],pt=ce("eye",Ps);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ss=ce("save",Ms);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ts=ce("settings",Fs);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],qs=ce("shield-check",Is);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],gt=ce("trending-up",Ls);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],Hs=ce("wallet",zs),Us={ar:{back:"رجوع",availabilityManagement:"إدارة المواعيد المتاحة",selectDays:"اختاري الأيام",selectDaysDesc:"اختاري الأيام الي حابة تشتغلي فيها",selectedDays:"الأيام المختارة",daySchedule:"مواعيد اليوم",availableFrom:"متاحة من",availableTo:"إلى",addTimeSlot:"إضافة وقت",removeTimeSlot:"حذف",saveSchedule:"حفظ المواعيد",bookedDays:"أيام محجوزة",availableDays:"أيام متاحة",unavailableDays:"أيام غير متاحة",morning:"صباحاً",evening:"مساءً",allDay:"طوال اليوم",customTime:"وقت مخصص",noTimeSlotsYet:"لم يتم تحديد أوقات بعد",mondayShort:"الإثنين",tuesdayShort:"الثلاثاء",wednesdayShort:"الأربعاء",thursdayShort:"الخميس",fridayShort:"الجمعة",saturdayShort:"السبت",sundayShort:"الأحد",saved:"تم الحفظ",invalidTime:"الوقت غير صحيح",repeatWeekly:"تكرار أسبوعياً",applyToAllDays:"تطبيق على كل الأيام",clearAll:"مسح الكل",quickPresets:"إعدادات سريعة",morningShift:"صباحي (8ص - 2م)",eveningShift:"مسائي (2م - 8م)",fullDay:"يوم كامل (8ص - 8م)",error:"حدث خطأ ما"},en:{back:"Back",availabilityManagement:"Availability Management",selectDays:"Select Days",selectDaysDesc:"Select the days you want to work",selectedDays:"Selected Days",daySchedule:"Day Schedule",availableFrom:"Available From",availableTo:"To",addTimeSlot:"Add Time",removeTimeSlot:"Remove",saveSchedule:"Save Schedule",bookedDays:"Booked Days",availableDays:"Available Days",unavailableDays:"Unavailable Days",morning:"AM",evening:"PM",allDay:"All Day",customTime:"Custom Time",noTimeSlotsYet:"No time slots set yet",mondayShort:"Monday",tuesdayShort:"Tuesday",wednesdayShort:"Wednesday",thursdayShort:"Thursday",fridayShort:"Friday",saturdayShort:"Saturday",sundayShort:"Sunday",saved:"Saved",invalidTime:"Invalid Time",repeatWeekly:"Repeat Weekly",applyToAllDays:"Apply to All Days",clearAll:"Clear All",quickPresets:"Quick Presets",morningShift:"Morning (8AM - 2PM)",eveningShift:"Evening (2PM - 8PM)",fullDay:"Full Day (8AM - 8PM)",error:"Something went wrong"}};function Vs({language:t,onBack:n}){const{user:l}=ae(),[i,a]=b.useState(void 0),[r,s]=b.useState({}),[d,c]=b.useState(0),[y,N]=b.useState(!1),p=Us[t],B=[new Date(2024,10,25),new Date(2024,10,26),new Date(2024,11,5)],w=f=>f.toISOString().split("T")[0];b.useEffect(()=>{l?.id&&M()},[l?.id]);const M=async()=>{if(l?.id)try{const f=await U.getAvailability(l.id),x={};f.forEach(_=>{_.date&&(x[_.date]||(x[_.date]=[]),x[_.date].push({id:_.id,from:_.start_time.substring(0,5),to:_.end_time.substring(0,5)}))});const C=Object.keys(x).map(_=>new Date(_));s(x),C.length>0&&a(C)}catch(f){console.error(f),T.error(p.error||"Failed to load availability")}finally{}},h=i?.[d],u=h?w(h):"",j=u?r[u]||[]:[],E=()=>{if(!u)return;const f={id:Date.now().toString(),from:"09:00",to:"17:00"};s(x=>({...x,[u]:[...x[u]||[],f]}))},g=f=>{u&&s(x=>({...x,[u]:x[u].filter(C=>C.id!==f)}))},v=(f,x,C)=>{u&&s(_=>({..._,[u]:_[u].map(O=>O.id===f?{...O,[x]:C}:O)}))},q=f=>{if(!u)return;const x={morning:[{id:Date.now().toString(),from:"08:00",to:"14:00"}],evening:[{id:Date.now().toString(),from:"14:00",to:"20:00"}],fullDay:[{id:Date.now().toString(),from:"08:00",to:"20:00"}]};s(C=>({...C,[u]:x[f]}))},o=()=>{if(!u||!i)return;const f=r[u];if(!f||f.length===0)return;const x={...r};i.forEach(C=>{const _=w(C);x[_]=f.map(O=>({...O,id:Date.now().toString()+Math.random()}))}),s(x)},m=()=>{s({}),a(void 0)},D=async()=>{if(l?.id)try{const f=Object.keys(r);await U.clearAvailabilityForDates(l.id,f);const x=[];for(const C of f){const _=r[C];for(const O of _)x.push({date:C,start_time:O.from,end_time:O.to,is_recurring:!1,day_of_week:null})}x.length>0&&await U.addAvailability(l.id,x),T.success(p.saved)}catch(f){console.error(f),T.error(p.error||"Failed to save")}finally{}},S=f=>[p.sundayShort,p.mondayShort,p.tuesdayShort,p.wednesdayShort,p.thursdayShort,p.fridayShort,p.saturdayShort][f.getDay()],R=f=>{const x=f.getDate(),C=f.getMonth()+1,_=f.getFullYear();return t==="ar"?`${x}/${C}/${_}`:`${C}/${x}/${_}`};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-50",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[n&&e.jsx(P,{onClick:n,variant:"ghost",className:"p-2",children:t==="ar"?e.jsx(Se,{className:"size-5"}):e.jsx(ke,{className:"size-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-xl",children:p.availabilityManagement}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:p.selectDaysDesc})]}),e.jsxs(P,{onClick:D,className:"bg-[#FB5E7A] hover:bg-[#e5536e]",children:[e.jsx(ss,{className:"size-4"}),p.saveSchedule]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg mb-2",children:p.selectDays}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:p.selectDaysDesc})]}),e.jsx(Qt,{mode:"multiple",selected:i,onSelect:a,disabled:f=>f<new Date(new Date().setHours(0,0,0,0))?!0:B.some(x=>w(x)===w(f)),modifiers:{booked:B},modifiersClassNames:{booked:"bg-gray-300 text-gray-500 line-through"},className:"rounded-md border mx-auto"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-[#FB5E7A] rounded-full"}),e.jsx("span",{className:"text-sm",children:p.selectedDays})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded-full"}),e.jsx("span",{className:"text-sm",children:p.bookedDays})]})]}),i&&i.length>0&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Fe,{id:"repeat-weekly",checked:y,onCheckedChange:f=>N(f)}),e.jsx(H,{htmlFor:"repeat-weekly",className:"text-sm cursor-pointer",children:p.repeatWeekly})]}),e.jsxs(P,{onClick:m,variant:"outline",size:"sm",className:"w-full",children:[e.jsx(Pe,{className:"size-4"}),p.clearAll]})]})]})}),e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg mb-2",children:p.daySchedule}),i&&i.length>0?e.jsx("div",{className:"flex gap-2 flex-wrap",children:i.map((f,x)=>e.jsxs(P,{onClick:()=>c(x),variant:d===x?"default":"outline",size:"sm",className:d===x?"bg-[#FB5E7A] hover:bg-[#e5536e]":"",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs",children:S(f)}),e.jsx("div",{className:"text-xs",children:R(f)})]}),r[w(f)]?.length>0&&e.jsx($,{className:"size-3"})]},w(f)))}):e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:p.selectDaysDesc})]}),h&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(H,{className:"text-sm mb-2 block",children:p.quickPresets}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(P,{onClick:()=>q("morning"),variant:"outline",size:"sm",children:p.morningShift}),e.jsx(P,{onClick:()=>q("evening"),variant:"outline",size:"sm",children:p.eveningShift}),e.jsx(P,{onClick:()=>q("fullDay"),variant:"outline",size:"sm",children:p.fullDay})]})]}),e.jsxs("div",{className:"space-y-3 border-t pt-4",children:[j.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ne,{className:"size-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:p.noTimeSlotsYet})]}):j.map(f=>e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(H,{className:"text-xs",children:p.availableFrom}),e.jsx(J,{type:"time",value:f.from,onChange:x=>v(f.id,"from",x.target.value),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(H,{className:"text-xs",children:p.availableTo}),e.jsx(J,{type:"time",value:f.to,onChange:x=>v(f.id,"to",x.target.value),className:"mt-1"})]})]}),e.jsx(P,{onClick:()=>g(f.id),variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-600 hover:bg-red-50",children:e.jsx(be,{className:"size-4"})})]},f.id)),e.jsxs(P,{onClick:E,variant:"outline",className:"w-full",children:[e.jsx(we,{className:"size-4"}),p.addTimeSlot]}),j.length>0&&i&&i.length>1&&e.jsxs(P,{onClick:o,variant:"outline",className:"w-full",children:[e.jsx($,{className:"size-4"}),p.applyToAllDays]})]})]})]})})]}),i&&i.length>0&&e.jsxs(z,{className:"mt-6 p-6",children:[e.jsx("h3",{className:"text-lg mb-4",children:p.selectedDays}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(f=>{const x=w(f),C=r[x]||[];return e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm",children:S(f)}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:R(f)})]}),C.length>0?e.jsxs(V,{className:"bg-green-500",children:[C.length," ",p.addTimeSlot]}):e.jsx(V,{variant:"outline",children:p.noTimeSlotsYet})]}),C.length>0&&e.jsx("div",{className:"space-y-1 text-xs",children:C.map(_=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"size-3"}),e.jsxs("span",{children:[_.from," - ",_.to]})]},_.id))})]},x)})})]})]})]})}const Ws={ar:{back:"رجوع",servicesManagement:"إدارة الخدمات والأسعار",serviceType:"نوع الخدمة",hourlyUrgent:"ساعات فردية (مستعجل)",weeklyContract:"دوام أسبوعي",monthlyContract:"دوام شهري",pricePerHour:"السعر بالساعة",pricePerWeek:"السعر الأسبوعي",pricePerMonth:"السعر الشهري",description:"وصف الخدمة",minimumHours:"الحد الأدنى للساعات",features:"مميزات الخدمة",addFeature:"إضافة ميزة",feature:"ميزة",saveServices:"حفظ الخدمات",egp:"جنيه",hours:"ساعات",perHour:"بالساعة",perWeek:"أسبوعياً",perMonth:"شهرياً",serviceActive:"الخدمة متاحة",serviceInactive:"الخدمة غير متاحة",enableService:"تفعيل الخدمة",saved:"تم الحفظ بنجاح",hourlyDesc:"خدمة الساعات الفردية للحالات المستعجلة",weeklyDesc:"عقد أسبوعي بعدد ساعات محدد في الأسبوع",monthlyDesc:"عقد شهري بنظام دوام كامل",minimumWeeklyHours:"الحد الأدنى للساعات الأسبوعية",minimumMonthlyHours:"الحد الأدنى للساعات الشهرية"},en:{back:"Back",servicesManagement:"Services & Pricing Management",serviceType:"Service Type",hourlyUrgent:"Hourly (Urgent)",weeklyContract:"Weekly Contract",monthlyContract:"Monthly Contract",pricePerHour:"Price Per Hour",pricePerWeek:"Weekly Price",pricePerMonth:"Monthly Price",description:"Service Description",minimumHours:"Minimum Hours",features:"Service Features",addFeature:"Add Feature",feature:"Feature",saveServices:"Save Services",egp:"EGP",hours:"hours",perHour:"per hour",perWeek:"per week",perMonth:"per month",serviceActive:"Service Active",serviceInactive:"Service Inactive",enableService:"Enable Service",saved:"Saved Successfully",hourlyDesc:"Hourly service for urgent cases",weeklyDesc:"Weekly contract with specific hours per week",monthlyDesc:"Monthly contract with full-time schedule",minimumWeeklyHours:"Minimum Weekly Hours",minimumMonthlyHours:"Minimum Monthly Hours"}};function Os({language:t,onBack:n}){const[l,i]=b.useState({enabled:!0,price:50,minimumHours:3,description:"",features:["رعاية أطفال","متاحة في أي وقت","استجابة سريعة"]}),[a,r]=b.useState({enabled:!0,price:1200,minimumHours:20,description:"",features:["20 ساعة أسبوعياً","جدول ثابت","أولوية في الحجز"]}),[s,d]=b.useState({enabled:!1,price:4e3,minimumHours:160,description:"",features:["دوام كامل","جدول مرن","خصم 20%"]}),c=Ws[t],[y,N]=b.useState(""),[p,B]=b.useState(""),[w,M]=b.useState(""),h=o=>{o==="hourly"&&y.trim()?(i(m=>({...m,features:[...m.features,y.trim()]})),N("")):o==="weekly"&&p.trim()?(r(m=>({...m,features:[...m.features,p.trim()]})),B("")):o==="monthly"&&w.trim()&&(d(m=>({...m,features:[...m.features,w.trim()]})),M(""))},u=(o,m)=>{o==="hourly"?i(D=>({...D,features:D.features.filter((S,R)=>R!==m)})):o==="weekly"?r(D=>({...D,features:D.features.filter((S,R)=>R!==m)})):o==="monthly"&&d(D=>({...D,features:D.features.filter((S,R)=>R!==m)}))},{user:j}=ae(),[E,g]=b.useState(!1);b.useEffect(()=>{j?.id&&v()},[j?.id]);const v=async()=>{try{if(g(!0),!j?.id)return;(await U.getServices(j.id)).forEach(m=>{const D={enabled:m.is_active!==!1,price:m.price,description:m.description||"",minimumHours:m.minimum_hours||1,features:Array.isArray(m.features)?m.features:JSON.parse(m.features||"[]")};m.service_type==="hourly"&&i(D),m.service_type==="weekly"&&r(D),m.service_type==="monthly"&&d(D)})}catch(o){console.error("Error loading services:",o),T.error(t==="ar"?"حدث خطأ في تحميل الخدمات":"Error loading services")}finally{g(!1)}},q=async()=>{try{if(g(!0),!j?.id)return;const o=[];o.push(U.upsertService(j.id,"hourly",l.price,l.description,l.minimumHours,l.features,l.enabled)),o.push(U.upsertService(j.id,"weekly",a.price,a.description,a.minimumHours,a.features,a.enabled)),o.push(U.upsertService(j.id,"monthly",s.price,s.description,s.minimumHours,s.features,s.enabled)),await Promise.all(o),T.success(c.saved)}catch(o){console.error("Error saving services:",o),T.error(t==="ar"?"حدث خطأ في حفظ الخدمات":"Error saving services")}finally{g(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-10",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(P,{onClick:n,variant:"ghost",className:"p-2",children:t==="ar"?e.jsx(Se,{className:"size-5"}):e.jsx(ke,{className:"size-5"})}),e.jsx("div",{className:"flex-1",children:e.jsx("h1",{className:"text-xl",children:c.servicesManagement})}),e.jsxs(P,{onClick:q,disabled:E,className:"bg-[#FB5E7A] hover:bg-[#e5536e]",children:[E?e.jsx(ee,{className:"size-4 animate-spin"}):e.jsx(ss,{className:"size-4"}),c.saveServices]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto p-4 space-y-6",children:[e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-[#FB5E7A]/10 flex items-center justify-center",children:e.jsx(ne,{className:"w-6 h-6 text-[#FB5E7A]"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg",children:c.hourlyUrgent}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:c.hourlyDesc})]})]}),e.jsx(Fe,{id:"hourly-enabled",checked:l.enabled,onCheckedChange:o=>i(m=>({...m,enabled:o}))})]}),l.enabled&&e.jsxs("div",{className:"space-y-4 border-t pt-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(H,{children:c.pricePerHour}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(J,{type:"number",value:l.price,onChange:o=>i(m=>({...m,price:Number(o.target.value)})),className:"pr-16"}),e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm text-gray-500",children:c.egp})]})]}),e.jsxs("div",{children:[e.jsx(H,{children:c.minimumHours}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(J,{type:"number",value:l.minimumHours,onChange:o=>i(m=>({...m,minimumHours:Number(o.target.value)})),className:"pr-16"}),e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm text-gray-500",children:c.hours})]})]})]}),e.jsxs("div",{children:[e.jsx(H,{children:c.description}),e.jsx(Ae,{value:l.description,onChange:o=>i(m=>({...m,description:o.target.value})),className:"mt-2",rows:3})]}),e.jsxs("div",{children:[e.jsx(H,{children:c.features}),e.jsxs("div",{className:"space-y-2 mt-2",children:[l.features.map((o,m)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[e.jsx("span",{className:"flex-1 text-sm",children:o}),e.jsx(P,{onClick:()=>u("hourly",m),variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-600",children:e.jsx(be,{className:"size-4"})})]},m)),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(J,{value:y,onChange:o=>N(o.target.value),placeholder:c.feature,onKeyPress:o=>o.key==="Enter"&&h("hourly")}),e.jsx(P,{onClick:()=>h("hourly"),variant:"outline",children:e.jsx(we,{className:"size-4"})})]})]})]})]})]})}),e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-500/10 flex items-center justify-center",children:e.jsx(ie,{className:"w-6 h-6 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg",children:c.weeklyContract}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:c.weeklyDesc})]})]}),e.jsx(Fe,{id:"weekly-enabled",checked:a.enabled,onCheckedChange:o=>r(m=>({...m,enabled:o}))})]}),a.enabled&&e.jsxs("div",{className:"space-y-4 border-t pt-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(H,{children:c.pricePerWeek}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(J,{type:"number",value:a.price,onChange:o=>r(m=>({...m,price:Number(o.target.value)})),className:"pr-16"}),e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm text-gray-500",children:c.egp})]})]}),e.jsxs("div",{children:[e.jsx(H,{children:c.minimumWeeklyHours}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(J,{type:"number",value:a.minimumHours,onChange:o=>r(m=>({...m,minimumHours:Number(o.target.value)})),className:"pr-16"}),e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm text-gray-500",children:c.hours})]})]})]}),e.jsxs("div",{children:[e.jsx(H,{children:c.description}),e.jsx(Ae,{value:a.description,onChange:o=>r(m=>({...m,description:o.target.value})),className:"mt-2",rows:3})]}),e.jsxs("div",{children:[e.jsx(H,{children:c.features}),e.jsxs("div",{className:"space-y-2 mt-2",children:[a.features.map((o,m)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[e.jsx("span",{className:"flex-1 text-sm",children:o}),e.jsx(P,{onClick:()=>u("weekly",m),variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-600",children:e.jsx(be,{className:"size-4"})})]},m)),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(J,{value:p,onChange:o=>B(o.target.value),placeholder:c.feature,onKeyPress:o=>o.key==="Enter"&&h("weekly")}),e.jsx(P,{onClick:()=>h("weekly"),variant:"outline",children:e.jsx(we,{className:"size-4"})})]})]})]})]})]})}),e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-green-500/10 flex items-center justify-center",children:e.jsx(Ds,{className:"w-6 h-6 text-green-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg",children:c.monthlyContract}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:c.monthlyDesc})]})]}),e.jsx(Fe,{id:"monthly-enabled",checked:s.enabled,onCheckedChange:o=>d(m=>({...m,enabled:o}))})]}),s.enabled&&e.jsxs("div",{className:"space-y-4 border-t pt-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(H,{children:c.pricePerMonth}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(J,{type:"number",value:s.price,onChange:o=>d(m=>({...m,price:Number(o.target.value)})),className:"pr-16"}),e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm text-gray-500",children:c.egp})]})]}),e.jsxs("div",{children:[e.jsx(H,{children:c.minimumMonthlyHours}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(J,{type:"number",value:s.minimumHours,onChange:o=>d(m=>({...m,minimumHours:Number(o.target.value)})),className:"pr-16"}),e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm text-gray-500",children:c.hours})]})]})]}),e.jsxs("div",{children:[e.jsx(H,{children:c.description}),e.jsx(Ae,{value:s.description,onChange:o=>d(m=>({...m,description:o.target.value})),className:"mt-2",rows:3})]}),e.jsxs("div",{children:[e.jsx(H,{children:c.features}),e.jsxs("div",{className:"space-y-2 mt-2",children:[s.features.map((o,m)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[e.jsx("span",{className:"flex-1 text-sm",children:o}),e.jsx(P,{onClick:()=>u("monthly",m),variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-600",children:e.jsx(be,{className:"size-4"})})]},m)),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(J,{value:w,onChange:o=>M(o.target.value),placeholder:c.feature,onKeyPress:o=>o.key==="Enter"&&h("monthly")}),e.jsx(P,{onClick:()=>h("monthly"),variant:"outline",children:e.jsx(we,{className:"size-4"})})]})]})]})]})]})})]})]})}const Js={ar:{back:"رجوع",verification:"توثيق الحساب",verificationRequired:"يجب توثيق حسابك لقبول الطلبات",policeRecord:"الفيش الجنائي",policeRecordDesc:"يرجى رفع صورة واضحة من الفيش الجنائي",uploadDocument:"رفع المستند",changeDocument:"تغيير المستند",nationalId:"البطاقة الشخصية",nationalIdDesc:"صورة من البطاقة الشخصية (الوجهين)",uploadFront:"رفع الوجه الأمامي",uploadBack:"رفع الوجه الخلفي",status:"الحالة",pending:"قيد المراجعة",approved:"موثق",rejected:"مرفوض",notUploaded:"لم يتم الرفع",uploadedSuccessfully:"تم الرفع بنجاح",submit:"إرسال للمراجعة",verificationPending:"طلب التوثيق قيد المراجعة",verificationApproved:"تم توثيق حسابك بنجاح",verificationRejected:"تم رفض طلب التوثيق",rejectionReason:"سبب الرفض",resubmit:"إعادة الإرسال",requirements:"المتطلبات",requirement1:"صورة واضحة للفيش الجنائي",requirement2:"صورة البطاقة الشخصية (الوجهين)",requirement3:"المستندات يجب أن تكون سارية",requirement4:"الصور يجب أن تكون واضحة ومقروءة",note:"ملحوظة",noteText:"عملية المراجعة تستغرق من 24-48 ساعة",cannotAcceptRequests:"لا يمكنك قبول طلبات حتى يتم توثيق حسابك",alreadyUploaded:"تم الرفع",fileSelected:"تم اختيار الملف"},en:{back:"Back",verification:"Account Verification",verificationRequired:"You must verify your account to accept requests",policeRecord:"Police Clearance Certificate",policeRecordDesc:"Please upload a clear copy of your police clearance certificate",uploadDocument:"Upload Document",changeDocument:"Change Document",nationalId:"National ID",nationalIdDesc:"Photo of National ID (both sides)",uploadFront:"Upload Front Side",uploadBack:"Upload Back Side",status:"Status",pending:"Under Review",approved:"Verified",rejected:"Rejected",notUploaded:"Not Uploaded",uploadedSuccessfully:"Uploaded Successfully",submit:"Submit for Review",verificationPending:"Verification request under review",verificationApproved:"Your account has been verified successfully",verificationRejected:"Verification request rejected",rejectionReason:"Rejection Reason",resubmit:"Resubmit",requirements:"Requirements",requirement1:"Clear photo of police clearance certificate",requirement2:"National ID photo (both sides)",requirement3:"Documents must be valid",requirement4:"Photos must be clear and readable",note:"Note",noteText:"Review process takes 24-48 hours",cannotAcceptRequests:"You cannot accept requests until your account is verified",alreadyUploaded:"Already Uploaded",fileSelected:"File Selected"}};function Ks({language:t,onBack:n}){const{user:l}=ae(),[i,a]=b.useState(null),[r,s]=b.useState(null),[d,c]=b.useState(null),[y,N]=b.useState({}),[p,B]=b.useState("not_submitted"),[w]=b.useState(""),[M,h]=b.useState(!1),u=Js[t];b.useEffect(()=>{l?.id&&j()},[l?.id]);const j=async()=>{try{if(!l?.id)return;const S=await U.getVerificationRequests(l.id),R={};let f="not_submitted";S.forEach(x=>{x.document_type==="police_record"&&(R.policeRecord=x.document_url),x.document_type==="national_id_front"&&(R.nationalIdFront=x.document_url),x.document_type==="national_id_back"&&(R.nationalIdBack=x.document_url),x.status==="rejected"?f="rejected":x.status==="pending"&&f!=="rejected"?f="pending":x.status==="approved"&&f!=="rejected"&&f!=="pending"&&(f="approved")}),N(R),S.length>0&&B(f)}catch(S){console.error(S),T.error("Failed to load verification status")}finally{}},E=S=>{S.target.files&&S.target.files[0]&&a(S.target.files[0])},g=S=>{S.target.files&&S.target.files[0]&&s(S.target.files[0])},v=S=>{S.target.files&&S.target.files[0]&&c(S.target.files[0])},q=async()=>{const S=i||y.policeRecord,R=r||y.nationalIdFront,f=d||y.nationalIdBack;if(!S||!R||!f){T.error(t==="ar"?"يرجى رفع جميع المستندات المطلوبة":"Please upload all required documents");return}try{if(!l?.id)return;if(h(!0),i){const x=await U.uploadVerificationDocument(l.id,i,"police_record");await U.submitVerificationRequest(l.id,"police_record",x),N(C=>({...C,policeRecord:x})),a(null)}if(r){const x=await U.uploadVerificationDocument(l.id,r,"national_id_front");await U.submitVerificationRequest(l.id,"national_id_front",x),N(C=>({...C,nationalIdFront:x})),s(null)}if(d){const x=await U.uploadVerificationDocument(l.id,d,"national_id_back");await U.submitVerificationRequest(l.id,"national_id_back",x),N(C=>({...C,nationalIdBack:x})),c(null)}B("pending"),T.success(t==="ar"?"تم إرسال طلب التوثيق بنجاح":"Verification request submitted successfully")}catch(x){console.error(x),T.error(t==="ar"?"حدث خطأ أثناء الرفع":"Error uploading documents")}finally{h(!1)}},o=()=>{switch(p){case"pending":return e.jsx(V,{className:"bg-yellow-500",children:u.pending});case"approved":return e.jsx(V,{className:"bg-green-500",children:u.approved});case"rejected":return e.jsx(V,{className:"bg-red-500",children:u.rejected});default:return e.jsx(V,{variant:"outline",children:u.notUploaded})}},m=(S,R,f,x,C)=>S?e.jsxs("div",{className:"space-y-3",children:[e.jsx(Te,{className:"size-10 mx-auto text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs",children:S.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(S.size/1024).toFixed(2)," KB"]})]}),e.jsx(H,{htmlFor:x,className:"cursor-pointer",children:e.jsx(P,{variant:"outline",size:"sm",asChild:!0,children:e.jsx("span",{children:u.changeDocument})})})]}):R?e.jsxs("div",{className:"space-y-3",children:[e.jsx($,{className:"size-10 mx-auto text-green-500"}),e.jsx("div",{children:e.jsx("p",{className:"text-sm font-medium text-green-600",children:u.alreadyUploaded})}),e.jsx(H,{htmlFor:x,className:"cursor-pointer",children:e.jsx(P,{variant:"outline",size:"sm",asChild:!0,children:e.jsx("span",{children:u.changeDocument})})})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx($t,{className:"size-10 mx-auto text-gray-400"}),e.jsx(H,{htmlFor:x,className:"cursor-pointer",children:e.jsx(P,{variant:"outline",size:"sm",asChild:!0,children:e.jsx("span",{children:f})})})]}),D=(i||y.policeRecord)&&(r||y.nationalIdFront)&&(d||y.nationalIdBack);return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-10",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(P,{onClick:n,variant:"ghost",className:"p-2",children:t==="ar"?e.jsx(Se,{className:"size-5"}):e.jsx(ke,{className:"size-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-xl",children:u.verification}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:u.verificationRequired})]}),o()]})})}),e.jsxs("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:[p==="not_submitted"&&e.jsxs(ye,{className:"border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20",children:[e.jsx(Be,{className:"h-4 w-4 text-yellow-600"}),e.jsx(je,{className:"text-yellow-800 dark:text-yellow-200",children:u.cannotAcceptRequests})]}),p==="pending"&&e.jsxs(ye,{className:"border-blue-500 bg-blue-50 dark:bg-blue-900/20",children:[e.jsx(Be,{className:"h-4 w-4 text-blue-600"}),e.jsx(je,{className:"text-blue-800 dark:text-blue-200",children:u.verificationPending})]}),p==="approved"&&e.jsxs(ye,{className:"border-green-500 bg-green-50 dark:bg-green-900/20",children:[e.jsx($,{className:"h-4 w-4 text-green-600"}),e.jsx(je,{className:"text-green-800 dark:text-green-200",children:u.verificationApproved})]}),p==="rejected"&&e.jsxs(ye,{className:"border-red-500 bg-red-50 dark:bg-red-900/20",children:[e.jsx(Pe,{className:"h-4 w-4 text-red-600"}),e.jsxs(je,{className:"text-red-800 dark:text-red-200",children:[e.jsx("div",{children:u.verificationRejected}),w&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsxs("strong",{children:[u.rejectionReason,":"]})," ",w]})]})]}),e.jsxs(z,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx(ze,{className:"w-6 h-6 text-[#FB5E7A] mt-1"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg mb-2",children:u.requirements}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx($,{className:"size-4 text-green-500 mt-0.5 shrink-0"}),e.jsx("span",{children:u.requirement1})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx($,{className:"size-4 text-green-500 mt-0.5 shrink-0"}),e.jsx("span",{children:u.requirement2})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx($,{className:"size-4 text-green-500 mt-0.5 shrink-0"}),e.jsx("span",{children:u.requirement3})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx($,{className:"size-4 text-green-500 mt-0.5 shrink-0"}),e.jsx("span",{children:u.requirement4})]})]})]})]}),e.jsxs(ye,{children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsxs(je,{children:[e.jsxs("strong",{children:[u.note,":"]})," ",u.noteText]})]})]}),e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-[#FB5E7A]/10 flex items-center justify-center",children:e.jsx(Te,{className:"w-6 h-6 text-[#FB5E7A]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg",children:u.policeRecord}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:u.policeRecordDesc})]}),(i||y.policeRecord)&&e.jsx($,{className:"size-6 text-green-500"})]}),e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center",children:[m(i,y.policeRecord,u.uploadDocument,"police-record-upload"),e.jsx(J,{id:"police-record-upload",type:"file",accept:"image/*,application/pdf",onChange:E,className:"hidden"})]})]})}),e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-500/10 flex items-center justify-center",children:e.jsx(Te,{className:"w-6 h-6 text-blue-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg",children:u.nationalId}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:u.nationalIdDesc})]}),(r||y.nationalIdFront)&&(d||y.nationalIdBack)&&e.jsx($,{className:"size-6 text-green-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-4 text-center",children:[m(r,y.nationalIdFront,u.uploadFront,"national-id-front"),e.jsx(J,{id:"national-id-front",type:"file",accept:"image/*",onChange:g,className:"hidden"})]}),e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-4 text-center",children:[m(d,y.nationalIdBack,u.uploadBack,"national-id-back"),e.jsx(J,{id:"national-id-back",type:"file",accept:"image/*",onChange:v,className:"hidden"})]})]})]})}),p!=="approved"&&e.jsx(P,{onClick:q,disabled:!D||M||p==="pending"&&!i&&!r&&!d,className:"w-full bg-[#FB5E7A] hover:bg-[#e5536e] disabled:opacity-50",size:"lg",children:M?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"mr-2 h-4 w-4 animate-spin"}),u.verificationPending]}):p==="rejected"?u.resubmit:u.submit})]})]})}const Ys={ar:{back:"رجوع",bookingRequests:"طلبات الحجز",pending:"قيد الانتظار",accepted:"مقبولة",rejected:"مرفوضة",noRequests:"لا توجد طلبات",accept:"قبول",decline:"رفض",client:"العميلة",service:"الخدمة",date:"التاريخ",time:"الوقت",duration:"المدة",hours:"ساعات",days:"أيام",location:"الموقع",amount:"المبلغ",egp:"جنيه",viewDetails:"عرض التفاصيل",requestDetails:"تفاصيل الطلب",acceptRequest:"قبول الطلب",declineRequest:"رفض الطلب",areYouSure:"هل أنت متأكدة؟",acceptConfirm:"سيتم إرسال إشعار للعميلة بقبول الطلب",declineConfirm:"سيتم إرسال إشعار للعميلة برفض الطلب",confirm:"تأكيد",cancel:"إلغاء",requestAccepted:"تم قبول الطلب",requestDeclined:"تم رفض الطلب",waitingPayment:"في انتظار الدفع من العميلة",paid:"تم الدفع",notes:"ملاحظات",phoneNumber:"رقم الهاتف",children:"عدد الأطفال",hourlyUrgent:"ساعات فردية (مستعجل)",weeklyContract:"دوام أسبوعي",monthlyContract:"دوام شهري",atHome:"في منزل العميلة",outside:"خارج المنزل"},en:{back:"Back",bookingRequests:"Booking Requests",pending:"Pending",accepted:"Accepted",rejected:"Rejected",noRequests:"No requests",accept:"Accept",decline:"Decline",client:"Client",service:"Service",date:"Date",time:"Time",duration:"Duration",hours:"hours",days:"days",location:"Location",amount:"Amount",egp:"EGP",viewDetails:"View Details",requestDetails:"Request Details",acceptRequest:"Accept Request",declineRequest:"Decline Request",areYouSure:"Are you sure?",acceptConfirm:"Client will be notified of your acceptance",declineConfirm:"Client will be notified of your rejection",confirm:"Confirm",cancel:"Cancel",requestAccepted:"Request Accepted",requestDeclined:"Request Declined",waitingPayment:"Waiting for client payment",paid:"Paid",notes:"Notes",phoneNumber:"Phone Number",children:"Number of Children",hourlyUrgent:"Hourly (Urgent)",weeklyContract:"Weekly Contract",monthlyContract:"Monthly Contract",atHome:"At Client Home",outside:"Outside"}};function Gs({language:t,isVerified:n,onBack:l}){const{user:i}=ae(),[a,r]=b.useState([]),[s,d]=b.useState(!0),[c,y]=b.useState(null);b.useEffect(()=>{p(),N()},[i?.id]);const N=async()=>{if(i?.id)try{const o=await U.getProfile(i.id);y(o)}catch(o){console.error(o)}},p=async()=>{if(i?.id)try{d(!0);const o=await se.getSitterBookings(i.id);r(o)}catch(o){console.error(o),T.error(t==="ar"?"خطأ في تحميل البيانات":"Error loading data")}finally{d(!1)}},[B,w]=b.useState(null),[M,h]=b.useState(null),u=Ys[t],j=async o=>{try{await se.updateStatus(o.id,"waiting_payment"),await Ne.createNotification({user_id:o.client_id,type:"booking_accepted",title:t==="ar"?"تم قبول طلبك":"Booking Accepted",message:t==="ar"?`تم قبول طلبك من أختك ${c?.full_name||"الخالة"}. يرجى إتمام عملية الدفع.`:`Your booking has been accepted by ${c?.full_name||"the sitter"}. Please complete the payment.`,data:{booking_id:o.id}}),T.success(t==="ar"?"تم قبول الطلب وبانتظار الدفع":"Request Accepted"),h(null),w(null),p()}catch(m){console.error(m),T.error(t==="ar"?"حدث خطأ":"Error occurred")}},E=async o=>{try{await se.updateStatus(o.id,"cancelled"),await Ne.createNotification({user_id:o.client_id,type:"booking_declined",title:t==="ar"?"تم رفض الطلب":"Booking Declined",message:t==="ar"?`نعتذر، تم اعتذار أختك ${c?.full_name||"الخالة"} عن قبول الطلب.`:`Sorry, ${c?.full_name||"the sitter"} has declined your booking request.`,data:{booking_id:o.id}}),T.success(t==="ar"?"تم رفض الطلب":"Request Declined"),h(null),w(null),p()}catch(m){console.error(m),T.error(t==="ar"?"حدث خطأ":"Error occurred")}},g=o=>{switch(o){case"pending":return e.jsx(V,{className:"bg-yellow-500",children:u.pending});case"accepted":return e.jsx(V,{className:"bg-blue-500",children:u.waitingPayment});case"paid":return e.jsx(V,{className:"bg-green-500",children:u.paid});case"rejected":return e.jsx(V,{className:"bg-red-500",children:u.rejected});default:return null}},v=a.filter(o=>o.status==="pending"),q=a.filter(o=>o.status!=="pending");return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-10",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(P,{onClick:l,variant:"ghost",className:"p-2",children:t==="ar"?e.jsx(Se,{className:"size-5"}):e.jsx(ke,{className:"size-5"})}),e.jsx("div",{className:"flex-1",children:e.jsx("h1",{className:"text-xl",children:u.bookingRequests})}),v.length>0&&e.jsx(V,{className:"bg-[#FB5E7A]",children:v.length})]})})}),e.jsxs("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:[!n&&e.jsxs(ye,{className:"border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20",children:[e.jsx(Be,{className:"h-4 w-4 text-yellow-600"}),e.jsx(je,{className:"text-yellow-800 dark:text-yellow-200",children:t==="ar"?"يجب توثيق حسابك لقبول الطلبات":"You must verify your account to accept requests"})]}),v.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg",children:u.pending}),v.map(o=>e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ht,{className:"w-12 h-12",children:e.jsx("img",{src:o.client?.avatar_url||"",alt:o.client?.full_name})}),e.jsxs("div",{children:[e.jsx("h3",{children:o.client?.full_name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:o.booking_type==="home"?u.atHome:u.outside})]})]}),g(o.status)]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"size-4 text-gray-400"}),e.jsx("span",{children:o.date})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"size-4 text-gray-400"}),e.jsx("span",{children:o.start_time})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"size-4 text-gray-400"}),e.jsxs("span",{children:[o.children_count||1," ",u.children]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-[#FB5E7A]",children:[o.total_price," ",u.egp]})})]}),e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(Ue,{className:"size-4 text-gray-400 mt-0.5 shrink-0"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:o.location})]}),o.notes&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-lg text-sm",children:[e.jsxs("strong",{children:[u.notes,":"]})," ",o.notes]}),e.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[e.jsxs(P,{onClick:()=>{w(o),h("accept")},disabled:!n,className:"flex-1 bg-green-500 hover:bg-green-600",children:[e.jsx($,{className:"size-4"}),u.accept]}),e.jsxs(P,{onClick:()=>{w(o),h("decline")},disabled:!n,variant:"outline",className:"flex-1 text-red-500 hover:text-red-600 hover:bg-red-50",children:[e.jsx(Pe,{className:"size-4"}),u.decline]})]})]})},o.id))]}),q.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg",children:[u.accepted," / ",u.rejected]}),q.map(o=>e.jsx(z,{className:"p-4 opacity-75",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ht,{className:"w-10 h-10",children:e.jsx("img",{src:o.client?.avatar_url||"",alt:o.client?.full_name})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm",children:o.client?.full_name}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:o.booking_type==="home"?u.atHome:u.outside})]})]}),g(o.status)]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[o.date," - ",o.start_time]}),e.jsxs("span",{className:"text-[#FB5E7A]",children:[o.total_price," ",u.egp]})]})]})},o.id))]}),s&&e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(ee,{className:"w-8 h-8 text-[#FB5E7A] animate-spin"})}),!s&&a.length===0&&e.jsxs(z,{className:"p-12 text-center",children:[e.jsx(Be,{className:"size-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:u.noRequests})]})]}),M&&B&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(z,{className:"max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-lg mb-4",children:M==="accept"?u.acceptRequest:u.declineRequest}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-6",children:M==="accept"?u.acceptConfirm:u.declineConfirm}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(P,{onClick:()=>{M==="accept"?j(B):E(B)},className:M==="accept"?"flex-1 bg-green-500 hover:bg-green-600":"flex-1 bg-red-500 hover:bg-red-600",children:u.confirm}),e.jsx(P,{onClick:()=>{h(null),w(null)},variant:"outline",className:"flex-1",children:u.cancel})]})]})})]})}const Qs={ar:{requestDetails:"تفاصيل الطلب",clientInfo:"بيانات العميل",bookingInfo:"تفاصيل الحجز",date:"التاريخ",time:"الوقت",duration:"المدة",location:"الموقع",price:"السعر",type:"النوع",children:"عدد الأطفال",notes:"ملاحظات",accept:"قبول الطلب",decline:"رفض الطلب",back:"رجوع",egp:"جنيه",hours:"ساعات",atHome:"في المنزل",outside:"خارج المنزل",child:"طفل",status:"الحالة",upcoming:"مؤكد (مدفوع)",ongoing:"جاري",completed:"مكتمل",pending:"قيد الانتظار",waiting_payment:"بانتظار الدفع",waitingPaymentDesc:"لقد قمتِ بقبول هذا الطلب. الحجز معلق حتى تقوم العميلة بإتمام عملية الدفع.",paymentConfirmed:"تم تأكيد الدفع"},en:{requestDetails:"Request Details",clientInfo:"Client Info",bookingInfo:"Booking Info",date:"Date",time:"Time",duration:"Duration",location:"Location",price:"Price",type:"Type",children:"Number of Children",notes:"Notes",accept:"Accept Request",decline:"Decline Request",back:"Back",egp:"EGP",hours:"hours",atHome:"At Home",outside:"Outside",child:"child",status:"Status",upcoming:"Confirmed (Paid)",ongoing:"Ongoing",completed:"Completed",pending:"Pending",waiting_payment:"Waiting for Payment",waitingPaymentDesc:"You have accepted this request. The booking is pending until the client completes the payment.",paymentConfirmed:"Payment Confirmed"}};function as({language:t,request:n,onBack:l,onAccept:i,onDecline:a,customActions:r}){const s=Qs[t],d=c=>{switch(c){case"pending":return e.jsx(V,{className:"bg-yellow-100 text-yellow-700 hover:bg-yellow-200",children:s.pending});case"waiting_payment":return e.jsx(V,{className:"bg-orange-100 text-orange-700 hover:bg-orange-200",children:s.waiting_payment});case"upcoming":return e.jsx(V,{className:"bg-blue-100 text-blue-700 hover:bg-blue-200",children:s.upcoming});case"ongoing":return e.jsx(V,{className:"bg-green-100 text-green-700 hover:bg-green-200",children:s.ongoing});case"completed":return e.jsx(V,{className:"bg-gray-100 text-gray-700 hover:bg-gray-200",children:s.completed});default:return e.jsx(V,{variant:"outline",children:c})}};return e.jsxs("div",{className:"max-w-4xl mx-auto px-4 pb-8 pt-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:l,className:"text-[#FB5E7A]",children:t==="ar"?e.jsx(Se,{className:"w-5 h-5"}):e.jsx(ke,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-bold text-[#FB5E7A]",children:s.requestDetails})]}),e.jsxs("div",{className:"grid gap-6",children:[n.status==="waiting_payment"&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(ne,{className:"w-5 h-5 text-orange-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-orange-700 mb-1",children:s.waiting_payment}),e.jsx("p",{className:"text-sm text-orange-600",children:s.waitingPaymentDesc})]})]}),n.status==="upcoming"&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(Ie,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-700 mb-1",children:s.paymentConfirmed}),e.jsx("p",{className:"text-sm text-green-600",children:t==="ar"?"قامت العميلة بالدفع. الحجز مؤكد الآن.":"Client has paid. Booking is now confirmed."})]})]}),e.jsxs(z,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(He,{className:"w-5 h-5 text-[#FB5E7A]"}),s.clientInfo]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:n.clientImage,alt:n.clientName,className:"w-20 h-20 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium",children:n.clientName}),e.jsxs("p",{className:"text-gray-500 text-sm flex items-center gap-1 mt-1",children:[e.jsx(Ue,{className:"w-4 h-4"}),n.location]})]})]})]}),e.jsxs(z,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(ie,{className:"w-5 h-5 text-[#FB5E7A]"}),s.bookingInfo]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between border-b pb-2",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:s.date}),e.jsx("span",{className:"font-medium",children:n.date})]}),e.jsxs("div",{className:"flex justify-between border-b pb-2",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:s.time}),e.jsx("span",{className:"font-medium",children:n.time})]}),e.jsxs("div",{className:"flex justify-between border-b pb-2",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:s.duration}),e.jsxs("span",{className:"font-medium",children:[n.duration," ",s.hours]})]}),e.jsxs("div",{className:"flex justify-between border-b pb-2",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:s.price}),e.jsxs("span",{className:"font-medium text-[#FB5E7A]",children:[n.price," ",s.egp]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between border-b pb-2",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:s.type}),e.jsx(V,{className:n.type==="home"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700",children:n.type==="home"?s.atHome:s.outside})]}),n.status&&e.jsxs("div",{className:"flex justify-between border-b pb-2",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:s.status}),d(n.status)]}),e.jsxs("div",{className:"flex justify-between border-b pb-2",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:s.children}),e.jsxs("span",{className:"font-medium",children:[n.children," ",s.child]})]}),e.jsxs("div",{className:"flex flex-col gap-2 pt-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:s.notes}),e.jsx("p",{className:"text-sm bg-gray-50 dark:bg-gray-800 p-3 rounded-lg min-h-[60px]",children:n.notes||(t==="ar"?"لا توجد ملاحظات":"No additional notes")})]})]})]})]}),r?e.jsx("div",{className:"pt-4",children:r}):i&&a&&e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsxs(P,{onClick:a,variant:"outline",className:"flex-1 h-12 border-red-500 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/10",children:[e.jsx(Pe,{className:"w-5 h-5 mr-2"}),s.decline]}),e.jsxs(P,{onClick:i,className:"flex-1 h-12 bg-green-600 hover:bg-green-700 text-white",children:[e.jsx($,{className:"w-5 h-5 mr-2"}),s.accept]})]})]})]})}const $s=t=>({id:t.id,clientName:t.client?.full_name||"---",clientImage:t.client?.avatar_url||"",date:t.date,time:t.start_time,duration:t.duration_hours,location:t.location,type:t.booking_type,price:t.total_price,children:t.children_count||1,status:t.status,notes:t.notes}),Xs={ar:{dashboard:"لوحة التحكم الخاصة بك اليوم",totalEarnings:"إجمالي الأرباح",completedJobs:"الجلسات المكتملة",totalHours:"إجمالي الساعات",rating:"التقييم العام",newRequests:"طلبات جديدة",noRequests:"لا توجد طلبات جديدة حالياً",viewDetails:"عرض التفاصيل",manageSchedule:"إدارة الجدول",manageServices:"إدارة الخدمات",verificationStatus:"حالة التوثيق",egp:"جنيه",hours:"ساعة",children:"أطفال",atHome:"في المنزل",outside:"خارج المنزل"},en:{dashboard:"Your sitter dashboard at a glance",totalEarnings:"Total Earnings",completedJobs:"Completed Jobs",totalHours:"Total Hours",rating:"Overall Rating",newRequests:"New Requests",noRequests:"No new requests at the moment",viewDetails:"View Details",manageSchedule:"Manage Schedule",manageServices:"Manage Services",verificationStatus:"Verification Status",egp:"EGP",hours:"hrs",children:"children",atHome:"At Home",outside:"Outside"}};function Zs({language:t}){const n=Xs[t],{user:l}=ae(),[i,a]=b.useState(!0),[r,s]=b.useState(!1),[d,c]=b.useState({totalEarnings:0,completedJobs:0,totalHours:0,rating:0,ratingCount:0}),[y,N]=b.useState([]),[p,B]=b.useState(!1),[w,M]=b.useState(!1),[h,u]=b.useState(!1),[j,E]=b.useState(!1),[g,v]=b.useState(null),[q,o]=b.useState(null),[m,D]=b.useState([]),[S,R]=b.useState(!1),[f,x]=b.useState(""),[C,_]=b.useState(""),O=()=>{if(!f||!C){T.error(t==="ar"?"يرجى ملء جميع الحقول":"Please fill all fields");return}T.success(t==="ar"?"تم استلام طلب السحب بنجاح":"Withdrawal request received successfully"),R(!1),x(""),_("")},G=async()=>{try{if(!l?.id)return;const F=await U.getProfile(l.id);o(F)}catch(F){console.error("Error loading profile:",F)}},I=async()=>{try{if(!l?.id)return;const F=await Ne.getRecentNotifications(l.id);D(F)}catch(F){console.error("Error loading notifications:",F)}};b.useEffect(()=>{if(l?.id){X(),G(),I();const F=Q.channel("sitter-notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${l.id}`},Y=>{const le=Y.new;D(Z=>[le,...Z])}).subscribe(),W=Q.channel("sitter-bookings").on("postgres_changes",{event:"*",schema:"public",table:"bookings",filter:`sitter_id=eq.${l.id}`},()=>{X()}).subscribe();return()=>{Q.removeChannel(F),Q.removeChannel(W)}}},[l?.id]);const X=async()=>{try{if(a(!0),s(!1),!l?.id)return;const[F,W]=await Promise.all([se.getSitterBookings(l.id),U.getStats(l.id)]);c({totalEarnings:Number(W.total_earnings||0),completedJobs:Number(W.completed_jobs||0),totalHours:Number(W.total_hours||0),rating:Number(W.average_rating||0),ratingCount:Number(W.review_count||0)}),N(F.filter(Y=>Y.status==="pending"))}catch(F){console.error("Error loading sitter home data:",F),s(!0),T.error(t==="ar"?"حدث خطأ في تحميل البيانات":"Error loading dashboard data")}finally{a(!1)}},oe=async F=>{try{await se.updateStatus(F.id,"waiting_payment"),await Ne.createNotification({user_id:F.client_id,type:"booking_accepted",title:t==="ar"?"تم قبول طلبك":"Booking Accepted",message:t==="ar"?`تم قبول طلبك من أختك ${q?.full_name||"الخالة"}. يرجى إتمام عملية الدفع.`:`Your booking has been accepted by ${q?.full_name||"the sitter"}. Please complete the payment.`,data:{booking_id:F.id}}),T.success(t==="ar"?"تم قبول الطلب وبانتظار الدفع":"Request accepted, waiting for payment"),X()}catch(W){console.error("Error accepting booking:",W),T.error(t==="ar"?"حدث خطأ":"Error updating status")}},te=async F=>{try{await se.updateStatus(F.id,"cancelled"),await Ne.createNotification({user_id:F.client_id,type:"booking_declined",title:t==="ar"?"تم رفض الطلب":"Booking Declined",message:t==="ar"?`نعتذر، تم اعتذار أختك ${q?.full_name||"الخالة"} عن قبول الطلب.`:`Sorry, ${q?.full_name||"the sitter"} has declined your booking request.`,data:{booking_id:F.id}}),T.success(t==="ar"?"تم رفض الطلب":"Request declined"),X()}catch(W){console.error("Error declining booking:",W),T.error(t==="ar"?"حدث خطأ":"Error updating status")}};return p?e.jsx(Vs,{language:t,onBack:()=>B(!1)}):w?e.jsx(Os,{language:t,onBack:()=>M(!1)}):h?e.jsx(Ks,{language:t,onBack:()=>u(!1)}):j?e.jsx(Gs,{language:t,onBack:()=>E(!1),isVerified:!0}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pb-20",children:[e.jsxs("div",{className:"max-w-4xl mx-auto px-4 pt-0 pb-8",children:[e.jsx("div",{className:"sticky top-0 z-50 bg-gray-50 dark:bg-gray-900 pt-6 pb-4 -mx-4 px-4 mb-4 border-b border-gray-100 dark:border-gray-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:l?.user_metadata?.avatar_url||"https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=400",alt:l?.user_metadata?.full_name,className:"w-12 h-12 rounded-full border-2 border-[#FFD1DA] object-cover"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-bold text-[#FB5E7A]",children:[t==="ar"?"مرحباً، ":"Welcome, ",q?.full_name?.split(" ")[0]||"Khala"]}),e.jsx("p",{className:"text-xs text-gray-500",children:n.dashboard})]})]}),e.jsxs(os,{children:[e.jsx(ds,{asChild:!0,children:e.jsxs(P,{variant:"outline",size:"icon",className:"rounded-full relative w-10 h-10",children:[e.jsx(ve,{className:"w-5 h-5"}),m.filter(F=>!F.is_read).length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-[#FB5E7A] text-white text-[10px] rounded-full flex items-center justify-center border-2 border-white",children:m.filter(F=>!F.is_read).length})]})}),e.jsxs(us,{className:"w-80 p-0",align:t==="ar"?"start":"end",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h3",{className:"font-semibold text-[#FB5E7A]",children:t==="ar"?"الإشعارات":"Notifications"})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:m.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(ve,{className:"w-12 h-12 mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-sm",children:t==="ar"?"لا توجد إشعارات":"No notifications"})]}):m.slice(0,5).map(F=>e.jsx("div",{className:`p-4 border-b hover:bg-gray-50 cursor-pointer ${F.is_read?"":"bg-[#FFD1DA]/10"}`,onClick:async()=>{if(F.is_read||(await Ne.markAsRead(F.id),D(W=>W.map(Y=>Y.id===F.id?{...Y,is_read:!0}:Y))),F.type==="new_booking"&&F.data?.booking_id)try{const W=await se.getBooking(F.data.booking_id);W&&v(W)}catch(W){console.error("Error loading booking:",W);const Y=y.find(le=>le.id===F.data.booking_id);Y?v(Y):T.error(t==="ar"?"حدث خطأ في تحميل الطلب":"Error loading request")}},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ve,{className:"w-4 h-4 text-[#FB5E7A] mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm",children:F.type==="new_booking"&&t==="ar"?"طلب حجز جديد":F.title}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:F.type==="new_booking"&&t==="ar"?`لديك طلب جديد من أختك ${F.data?.client_name||""}`:F.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(F.created_at).toLocaleDateString(t==="ar"?"ar-EG":"en-US")})]}),!F.is_read&&e.jsx("div",{className:"w-2 h-2 bg-[#FB5E7A] rounded-full mt-2"})]})},F.id))})]})]})]})}),i?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-400",children:[e.jsx(ee,{className:"w-12 h-12 animate-spin mb-4"}),e.jsx("p",{children:t==="ar"?"جاري التحميل...":"Loading..."})]}):r?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t==="ar"?"فشل تحميل البيانات":"Failed to load data"}),e.jsx(P,{onClick:X,variant:"outline",className:"mt-4",children:t==="ar"?"إعادة المحاولة":"Retry"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs(P,{variant:"outline",className:"h-auto py-6 flex flex-col gap-2 border-dashed border-2 hover:border-[#FB5E7A] hover:bg-[#FB5E7A]/5",onClick:()=>B(!0),children:[e.jsx(ie,{className:"w-6 h-6 text-[#FB5E7A]"}),e.jsx("p",{className:"text-sm font-bold",children:n.manageSchedule})]}),e.jsxs(P,{variant:"outline",className:"h-auto py-6 flex flex-col gap-2 border-dashed border-2 hover:border-[#FB5E7A] hover:bg-[#FB5E7A]/5",onClick:()=>M(!0),children:[e.jsx(Ts,{className:"w-6 h-6 text-[#FB5E7A]"}),e.jsx("p",{className:"text-sm font-bold",children:n.manageServices})]}),e.jsxs(P,{variant:"outline",className:"h-auto py-6 flex flex-col gap-2 border-dashed border-2 hover:border-[#FB5E7A] hover:bg-[#FB5E7A]/5 md:col-span-1 col-span-2",onClick:()=>u(!0),children:[e.jsx(qs,{className:"w-6 h-6 text-[#FB5E7A]"}),e.jsx("p",{className:"text-sm font-bold",children:n.verificationStatus})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(z,{className:"p-4 relative overflow-hidden group",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"p-2 w-fit rounded-lg bg-green-100 text-green-600",children:e.jsx(gt,{className:"w-5 h-5"})}),e.jsx(P,{variant:"ghost",size:"icon",className:"h-8 w-8 text-green-600 hover:text-green-700 hover:bg-green-100",onClick:()=>R(!0),title:t==="ar"?"سحب الأموال":"Withdraw Funds",children:e.jsx(Hs,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-sm text-gray-500",children:n.totalEarnings}),e.jsxs("h3",{className:"text-xl font-bold text-[#FB5E7A]",children:[d.totalEarnings," ",n.egp]})]})}),e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"p-2 w-fit rounded-lg bg-blue-100 text-blue-600",children:e.jsx(ie,{className:"w-5 h-5"})}),e.jsx("p",{className:"text-sm text-gray-500",children:n.completedJobs}),e.jsx("h3",{className:"text-xl font-bold text-[#FB5E7A]",children:d.completedJobs})]})}),e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"p-2 w-fit rounded-lg bg-purple-100 text-purple-600",children:e.jsx(ne,{className:"w-5 h-5"})}),e.jsx("p",{className:"text-sm text-gray-500",children:n.totalHours}),e.jsx("h3",{className:"text-xl font-bold text-[#FB5E7A]",children:d.totalHours})]})}),e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"p-2 w-fit rounded-lg bg-yellow-100 text-yellow-600",children:e.jsx(xt,{className:"w-5 h-5"})}),e.jsx("p",{className:"text-sm text-gray-500",children:n.rating}),e.jsx("h3",{className:"text-xl font-bold text-[#FB5E7A]",children:d.rating})]})})]}),e.jsx(Re,{open:S,onOpenChange:R,children:e.jsxs(_e,{children:[e.jsx(qe,{children:e.jsx(Le,{children:t==="ar"?"طلب سحب رصيد":"Withdrawal Request"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{children:t==="ar"?"المبلغ المطلوب (جنيه)":"Amount (EGP)"}),e.jsx(J,{type:"number",value:f,onChange:F=>x(F.target.value),placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{children:t==="ar"?"الرقم القومي (للتأكيد)":"National ID (Confirmation)"}),e.jsx(J,{value:C,onChange:F=>_(F.target.value),placeholder:t==="ar"?"أدخل الرقم القومي":"Enter National ID"})]}),e.jsx("div",{className:"pt-2",children:e.jsx(P,{className:"w-full bg-[#FB5E7A] hover:bg-[#e5536e]",onClick:O,children:t==="ar"?"إرسال الطلب":"Submit Request"})})]})]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"mb-4 font-bold flex items-center gap-2",children:[e.jsx(ve,{className:"w-5 h-5 text-[#FB5E7A]"}),n.newRequests]}),y.length===0?e.jsx(z,{className:"p-8 text-center text-gray-500",children:n.noRequests}):e.jsx("div",{className:"space-y-4",children:y.map(F=>e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("img",{src:F.client?.avatar_url||"",className:"w-16 h-16 rounded-full object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold",children:F.client?.full_name}),e.jsxs(V,{variant:"outline",children:["1 ",n.children]})]}),e.jsx(V,{className:"bg-[#FB5E7A]/10 text-[#FB5E7A] border-none",children:F.booking_type==="home"?n.atHome:n.outside})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-y-1 text-sm text-gray-500 mb-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"w-4 h-4"})," ",F.date]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ne,{className:"w-4 h-4"})," ",F.start_time]})]}),e.jsxs(P,{onClick:()=>v(F),className:"w-full bg-[#FB5E7A]",children:[e.jsx(pt,{className:"w-4 h-4 mr-2"})," ",n.viewDetails]})]})]})},F.id))})]})]})]}),g&&e.jsx(Re,{open:!!g,onOpenChange:F=>!F&&v(null),children:e.jsx(_e,{className:"max-w-4xl p-0 max-h-[90vh] overflow-y-auto",children:e.jsx(as,{request:$s(g),language:t,onBack:()=>v(null),onAccept:g.status==="pending"?async()=>{await oe(g),v(null)}:void 0,onDecline:g.status==="pending"?async()=>{await te(g),v(null)}:void 0})})})]})}const ea={ar:{typeMessage:"اكتب رسالة...",online:"متصل الآن",send:"إرسال"},en:{typeMessage:"Type a message...",online:"Online",send:"Send"}};function ta({language:t,onBack:n,bookingId:l,recipientId:i,recipientName:a="User",recipientImage:r}){const{user:s}=ae(),[d,c]=b.useState([]),[y,N]=b.useState(""),p=ea[t],B=b.useRef(null),w=()=>{B.current?.scrollIntoView({behavior:"smooth"})};b.useEffect(()=>{if(l&&s?.id){M();const j=Ce.subscribeToMessages(l,E=>{c(g=>g.some(v=>v.id.toLowerCase()===E.id.toLowerCase())?g:[...g,E]),E.receiver_id===s.id&&Ce.markAsRead(l,s.id)});return()=>{Q.removeChannel(j)}}},[l,s?.id]),b.useEffect(()=>{w()},[d]);const M=async()=>{try{if(!l)return;const j=await Ce.getMessages(l);c(j),s?.id&&await Ce.markAsRead(l,s.id)}catch(j){console.error(j)}},h=async()=>{if(!y.trim()||!s?.id)return;const j=y;N("");try{const E=await Ce.sendMessage(l,s.id,i,j);c(g=>g.some(v=>v.id.toLowerCase()===E.id.toLowerCase())?g:[...g,E])}catch(E){console.error(E)}},u=j=>new Date(j).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"flex flex-col h-[calc(100vh-80px)] bg-gray-50 dark:bg-gray-900",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 shadow-sm flex items-center gap-3 sticky top-0 z-10",children:[e.jsx(P,{variant:"ghost",size:"icon",onClick:n,children:t==="ar"?e.jsx(Se,{className:"w-5 h-5"}):e.jsx(ke,{className:"w-5 h-5"})}),e.jsxs(ht,{className:"h-10 w-10 border",children:[e.jsx(ms,{src:r}),e.jsx(hs,{children:a[0]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-sm",children:a}),e.jsxs("span",{className:"text-xs text-green-500 flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),p.online]})]}),e.jsx(P,{variant:"ghost",size:"icon",children:e.jsx(gs,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[d.map(j=>e.jsx("div",{className:`flex ${j.sender_id===s?.id?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[75%] p-3 rounded-2xl ${j.sender_id===s?.id?"bg-[#FB5E7A] text-white rounded-br-none":"bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-bl-none shadow-sm"}`,children:[e.jsx("p",{className:"text-sm",children:j.content}),e.jsx("span",{className:`text-[10px] mt-1 block ${j.sender_id===s?.id?"text-white/80":"text-gray-400"}`,children:u(j.created_at)})]})},j.id)),e.jsx("div",{ref:B})]}),e.jsx("div",{className:"p-4 bg-white dark:bg-gray-800 border-t",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{variant:"ghost",size:"icon",className:"text-gray-400",children:e.jsx(xs,{className:"w-5 h-5"})}),e.jsx(P,{variant:"ghost",size:"icon",className:"text-gray-400",children:e.jsx(Xt,{className:"w-5 h-5"})}),e.jsx(J,{value:y,onChange:j=>N(j.target.value),onKeyPress:j=>j.key==="Enter"&&h(),placeholder:p.typeMessage,className:"flex-1 bg-gray-100 dark:bg-gray-700 border-none rounded-full"}),e.jsx(P,{onClick:h,className:"bg-[#FB5E7A] hover:bg-[#e5536e] rounded-full w-10 h-10 p-0 flex items-center justify-center",children:e.jsx(fs,{className:"w-4 h-4 text-white"})})]})})]})}var pe={},We,bt;function sa(){return bt||(bt=1,We=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),We}var Oe={},de={},wt;function he(){if(wt)return de;wt=1;let t;const n=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return de.getSymbolSize=function(i){if(!i)throw new Error('"version" cannot be null or undefined');if(i<1||i>40)throw new Error('"version" should be in range from 1 to 40');return i*4+17},de.getSymbolTotalCodewords=function(i){return n[i]},de.getBCHDigit=function(l){let i=0;for(;l!==0;)i++,l>>>=1;return i},de.setToSJISFunction=function(i){if(typeof i!="function")throw new Error('"toSJISFunc" is not a valid function.');t=i},de.isKanjiModeEnabled=function(){return typeof t<"u"},de.toSJIS=function(i){return t(i)},de}var Je={},St;function yt(){return St||(St=1,(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function n(l){if(typeof l!="string")throw new Error("Param is not a string");switch(l.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+l)}}t.isValid=function(i){return i&&typeof i.bit<"u"&&i.bit>=0&&i.bit<4},t.from=function(i,a){if(t.isValid(i))return i;try{return n(i)}catch{return a}}})(Je)),Je}var Ke,kt;function aa(){if(kt)return Ke;kt=1;function t(){this.buffer=[],this.length=0}return t.prototype={get:function(n){const l=Math.floor(n/8);return(this.buffer[l]>>>7-n%8&1)===1},put:function(n,l){for(let i=0;i<l;i++)this.putBit((n>>>l-i-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){const l=Math.floor(this.length/8);this.buffer.length<=l&&this.buffer.push(0),n&&(this.buffer[l]|=128>>>this.length%8),this.length++}},Ke=t,Ke}var Ye,Ct;function ra(){if(Ct)return Ye;Ct=1;function t(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}return t.prototype.set=function(n,l,i,a){const r=n*this.size+l;this.data[r]=i,a&&(this.reservedBit[r]=!0)},t.prototype.get=function(n,l){return this.data[n*this.size+l]},t.prototype.xor=function(n,l,i){this.data[n*this.size+l]^=i},t.prototype.isReserved=function(n,l){return this.reservedBit[n*this.size+l]},Ye=t,Ye}var Ge={},Et;function na(){return Et||(Et=1,(function(t){const n=he().getSymbolSize;t.getRowColCoords=function(i){if(i===1)return[];const a=Math.floor(i/7)+2,r=n(i),s=r===145?26:Math.ceil((r-13)/(2*a-2))*2,d=[r-7];for(let c=1;c<a-1;c++)d[c]=d[c-1]-s;return d.push(6),d.reverse()},t.getPositions=function(i){const a=[],r=t.getRowColCoords(i),s=r.length;for(let d=0;d<s;d++)for(let c=0;c<s;c++)d===0&&c===0||d===0&&c===s-1||d===s-1&&c===0||a.push([r[d],r[c]]);return a}})(Ge)),Ge}var Qe={},At;function ia(){if(At)return Qe;At=1;const t=he().getSymbolSize,n=7;return Qe.getPositions=function(i){const a=t(i);return[[0,0],[a-n,0],[0,a-n]]},Qe}var $e={},Bt;function la(){return Bt||(Bt=1,(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const n={N1:3,N2:3,N3:40,N4:10};t.isValid=function(a){return a!=null&&a!==""&&!isNaN(a)&&a>=0&&a<=7},t.from=function(a){return t.isValid(a)?parseInt(a,10):void 0},t.getPenaltyN1=function(a){const r=a.size;let s=0,d=0,c=0,y=null,N=null;for(let p=0;p<r;p++){d=c=0,y=N=null;for(let B=0;B<r;B++){let w=a.get(p,B);w===y?d++:(d>=5&&(s+=n.N1+(d-5)),y=w,d=1),w=a.get(B,p),w===N?c++:(c>=5&&(s+=n.N1+(c-5)),N=w,c=1)}d>=5&&(s+=n.N1+(d-5)),c>=5&&(s+=n.N1+(c-5))}return s},t.getPenaltyN2=function(a){const r=a.size;let s=0;for(let d=0;d<r-1;d++)for(let c=0;c<r-1;c++){const y=a.get(d,c)+a.get(d,c+1)+a.get(d+1,c)+a.get(d+1,c+1);(y===4||y===0)&&s++}return s*n.N2},t.getPenaltyN3=function(a){const r=a.size;let s=0,d=0,c=0;for(let y=0;y<r;y++){d=c=0;for(let N=0;N<r;N++)d=d<<1&2047|a.get(y,N),N>=10&&(d===1488||d===93)&&s++,c=c<<1&2047|a.get(N,y),N>=10&&(c===1488||c===93)&&s++}return s*n.N3},t.getPenaltyN4=function(a){let r=0;const s=a.data.length;for(let c=0;c<s;c++)r+=a.data[c];return Math.abs(Math.ceil(r*100/s/5)-10)*n.N4};function l(i,a,r){switch(i){case t.Patterns.PATTERN000:return(a+r)%2===0;case t.Patterns.PATTERN001:return a%2===0;case t.Patterns.PATTERN010:return r%3===0;case t.Patterns.PATTERN011:return(a+r)%3===0;case t.Patterns.PATTERN100:return(Math.floor(a/2)+Math.floor(r/3))%2===0;case t.Patterns.PATTERN101:return a*r%2+a*r%3===0;case t.Patterns.PATTERN110:return(a*r%2+a*r%3)%2===0;case t.Patterns.PATTERN111:return(a*r%3+(a+r)%2)%2===0;default:throw new Error("bad maskPattern:"+i)}}t.applyMask=function(a,r){const s=r.size;for(let d=0;d<s;d++)for(let c=0;c<s;c++)r.isReserved(c,d)||r.xor(c,d,l(a,c,d))},t.getBestMask=function(a,r){const s=Object.keys(t.Patterns).length;let d=0,c=1/0;for(let y=0;y<s;y++){r(y),t.applyMask(y,a);const N=t.getPenaltyN1(a)+t.getPenaltyN2(a)+t.getPenaltyN3(a)+t.getPenaltyN4(a);t.applyMask(y,a),N<c&&(c=N,d=y)}return d}})($e)),$e}var Me={},Dt;function rs(){if(Dt)return Me;Dt=1;const t=yt(),n=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],l=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return Me.getBlocksCount=function(a,r){switch(r){case t.L:return n[(a-1)*4+0];case t.M:return n[(a-1)*4+1];case t.Q:return n[(a-1)*4+2];case t.H:return n[(a-1)*4+3];default:return}},Me.getTotalCodewordsCount=function(a,r){switch(r){case t.L:return l[(a-1)*4+0];case t.M:return l[(a-1)*4+1];case t.Q:return l[(a-1)*4+2];case t.H:return l[(a-1)*4+3];default:return}},Me}var Xe={},Ee={},Rt;function ca(){if(Rt)return Ee;Rt=1;const t=new Uint8Array(512),n=new Uint8Array(256);return(function(){let i=1;for(let a=0;a<255;a++)t[a]=i,n[i]=a,i<<=1,i&256&&(i^=285);for(let a=255;a<512;a++)t[a]=t[a-255]})(),Ee.log=function(i){if(i<1)throw new Error("log("+i+")");return n[i]},Ee.exp=function(i){return t[i]},Ee.mul=function(i,a){return i===0||a===0?0:t[n[i]+n[a]]},Ee}var _t;function oa(){return _t||(_t=1,(function(t){const n=ca();t.mul=function(i,a){const r=new Uint8Array(i.length+a.length-1);for(let s=0;s<i.length;s++)for(let d=0;d<a.length;d++)r[s+d]^=n.mul(i[s],a[d]);return r},t.mod=function(i,a){let r=new Uint8Array(i);for(;r.length-a.length>=0;){const s=r[0];for(let c=0;c<a.length;c++)r[c]^=n.mul(a[c],s);let d=0;for(;d<r.length&&r[d]===0;)d++;r=r.slice(d)}return r},t.generateECPolynomial=function(i){let a=new Uint8Array([1]);for(let r=0;r<i;r++)a=t.mul(a,new Uint8Array([1,n.exp(r)]));return a}})(Xe)),Xe}var Ze,Pt;function da(){if(Pt)return Ze;Pt=1;const t=oa();function n(l){this.genPoly=void 0,this.degree=l,this.degree&&this.initialize(this.degree)}return n.prototype.initialize=function(i){this.degree=i,this.genPoly=t.generateECPolynomial(this.degree)},n.prototype.encode=function(i){if(!this.genPoly)throw new Error("Encoder not initialized");const a=new Uint8Array(i.length+this.degree);a.set(i);const r=t.mod(a,this.genPoly),s=this.degree-r.length;if(s>0){const d=new Uint8Array(this.degree);return d.set(r,s),d}return r},Ze=n,Ze}var et={},tt={},st={},Mt;function ns(){return Mt||(Mt=1,st.isValid=function(n){return!isNaN(n)&&n>=1&&n<=40}),st}var re={},Ft;function is(){if(Ft)return re;Ft=1;const t="[0-9]+",n="[A-Z $%*+\\-./:]+";let l="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";l=l.replace(/u/g,"\\u");const i="(?:(?![A-Z0-9 $%*+\\-./:]|"+l+`)(?:.|[\r
]))+`;re.KANJI=new RegExp(l,"g"),re.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),re.BYTE=new RegExp(i,"g"),re.NUMERIC=new RegExp(t,"g"),re.ALPHANUMERIC=new RegExp(n,"g");const a=new RegExp("^"+l+"$"),r=new RegExp("^"+t+"$"),s=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return re.testKanji=function(c){return a.test(c)},re.testNumeric=function(c){return r.test(c)},re.testAlphanumeric=function(c){return s.test(c)},re}var Tt;function ge(){return Tt||(Tt=1,(function(t){const n=ns(),l=is();t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(r,s){if(!r.ccBits)throw new Error("Invalid mode: "+r);if(!n.isValid(s))throw new Error("Invalid version: "+s);return s>=1&&s<10?r.ccBits[0]:s<27?r.ccBits[1]:r.ccBits[2]},t.getBestModeForData=function(r){return l.testNumeric(r)?t.NUMERIC:l.testAlphanumeric(r)?t.ALPHANUMERIC:l.testKanji(r)?t.KANJI:t.BYTE},t.toString=function(r){if(r&&r.id)return r.id;throw new Error("Invalid mode")},t.isValid=function(r){return r&&r.bit&&r.ccBits};function i(a){if(typeof a!="string")throw new Error("Param is not a string");switch(a.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+a)}}t.from=function(r,s){if(t.isValid(r))return r;try{return i(r)}catch{return s}}})(tt)),tt}var It;function ua(){return It||(It=1,(function(t){const n=he(),l=rs(),i=yt(),a=ge(),r=ns(),s=7973,d=n.getBCHDigit(s);function c(B,w,M){for(let h=1;h<=40;h++)if(w<=t.getCapacity(h,M,B))return h}function y(B,w){return a.getCharCountIndicator(B,w)+4}function N(B,w){let M=0;return B.forEach(function(h){const u=y(h.mode,w);M+=u+h.getBitsLength()}),M}function p(B,w){for(let M=1;M<=40;M++)if(N(B,M)<=t.getCapacity(M,w,a.MIXED))return M}t.from=function(w,M){return r.isValid(w)?parseInt(w,10):M},t.getCapacity=function(w,M,h){if(!r.isValid(w))throw new Error("Invalid QR Code version");typeof h>"u"&&(h=a.BYTE);const u=n.getSymbolTotalCodewords(w),j=l.getTotalCodewordsCount(w,M),E=(u-j)*8;if(h===a.MIXED)return E;const g=E-y(h,w);switch(h){case a.NUMERIC:return Math.floor(g/10*3);case a.ALPHANUMERIC:return Math.floor(g/11*2);case a.KANJI:return Math.floor(g/13);case a.BYTE:default:return Math.floor(g/8)}},t.getBestVersionForData=function(w,M){let h;const u=i.from(M,i.M);if(Array.isArray(w)){if(w.length>1)return p(w,u);if(w.length===0)return 1;h=w[0]}else h=w;return c(h.mode,h.getLength(),u)},t.getEncodedBits=function(w){if(!r.isValid(w)||w<7)throw new Error("Invalid QR Code version");let M=w<<12;for(;n.getBCHDigit(M)-d>=0;)M^=s<<n.getBCHDigit(M)-d;return w<<12|M}})(et)),et}var at={},qt;function ma(){if(qt)return at;qt=1;const t=he(),n=1335,l=21522,i=t.getBCHDigit(n);return at.getEncodedBits=function(r,s){const d=r.bit<<3|s;let c=d<<10;for(;t.getBCHDigit(c)-i>=0;)c^=n<<t.getBCHDigit(c)-i;return(d<<10|c)^l},at}var rt={},nt,Lt;function ha(){if(Lt)return nt;Lt=1;const t=ge();function n(l){this.mode=t.NUMERIC,this.data=l.toString()}return n.getBitsLength=function(i){return 10*Math.floor(i/3)+(i%3?i%3*3+1:0)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(i){let a,r,s;for(a=0;a+3<=this.data.length;a+=3)r=this.data.substr(a,3),s=parseInt(r,10),i.put(s,10);const d=this.data.length-a;d>0&&(r=this.data.substr(a),s=parseInt(r,10),i.put(s,d*3+1))},nt=n,nt}var it,zt;function ga(){if(zt)return it;zt=1;const t=ge(),n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function l(i){this.mode=t.ALPHANUMERIC,this.data=i}return l.getBitsLength=function(a){return 11*Math.floor(a/2)+6*(a%2)},l.prototype.getLength=function(){return this.data.length},l.prototype.getBitsLength=function(){return l.getBitsLength(this.data.length)},l.prototype.write=function(a){let r;for(r=0;r+2<=this.data.length;r+=2){let s=n.indexOf(this.data[r])*45;s+=n.indexOf(this.data[r+1]),a.put(s,11)}this.data.length%2&&a.put(n.indexOf(this.data[r]),6)},it=l,it}var lt,Ht;function xa(){if(Ht)return lt;Ht=1;const t=ge();function n(l){this.mode=t.BYTE,typeof l=="string"?this.data=new TextEncoder().encode(l):this.data=new Uint8Array(l)}return n.getBitsLength=function(i){return i*8},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(l){for(let i=0,a=this.data.length;i<a;i++)l.put(this.data[i],8)},lt=n,lt}var ct,Ut;function fa(){if(Ut)return ct;Ut=1;const t=ge(),n=he();function l(i){this.mode=t.KANJI,this.data=i}return l.getBitsLength=function(a){return a*13},l.prototype.getLength=function(){return this.data.length},l.prototype.getBitsLength=function(){return l.getBitsLength(this.data.length)},l.prototype.write=function(i){let a;for(a=0;a<this.data.length;a++){let r=n.toSJIS(this.data[a]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[a]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),i.put(r,13)}},ct=l,ct}var ot={exports:{}},Vt;function pa(){return Vt||(Vt=1,(function(t){var n={single_source_shortest_paths:function(l,i,a){var r={},s={};s[i]=0;var d=n.PriorityQueue.make();d.push(i,0);for(var c,y,N,p,B,w,M,h,u;!d.empty();){c=d.pop(),y=c.value,p=c.cost,B=l[y]||{};for(N in B)B.hasOwnProperty(N)&&(w=B[N],M=p+w,h=s[N],u=typeof s[N]>"u",(u||h>M)&&(s[N]=M,d.push(N,M),r[N]=y))}if(typeof a<"u"&&typeof s[a]>"u"){var j=["Could not find a path from ",i," to ",a,"."].join("");throw new Error(j)}return r},extract_shortest_path_from_predecessor_list:function(l,i){for(var a=[],r=i;r;)a.push(r),l[r],r=l[r];return a.reverse(),a},find_path:function(l,i,a){var r=n.single_source_shortest_paths(l,i,a);return n.extract_shortest_path_from_predecessor_list(r,a)},PriorityQueue:{make:function(l){var i=n.PriorityQueue,a={},r;l=l||{};for(r in i)i.hasOwnProperty(r)&&(a[r]=i[r]);return a.queue=[],a.sorter=l.sorter||i.default_sorter,a},default_sorter:function(l,i){return l.cost-i.cost},push:function(l,i){var a={value:l,cost:i};this.queue.push(a),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=n})(ot)),ot.exports}var Wt;function ya(){return Wt||(Wt=1,(function(t){const n=ge(),l=ha(),i=ga(),a=xa(),r=fa(),s=is(),d=he(),c=pa();function y(j){return unescape(encodeURIComponent(j)).length}function N(j,E,g){const v=[];let q;for(;(q=j.exec(g))!==null;)v.push({data:q[0],index:q.index,mode:E,length:q[0].length});return v}function p(j){const E=N(s.NUMERIC,n.NUMERIC,j),g=N(s.ALPHANUMERIC,n.ALPHANUMERIC,j);let v,q;return d.isKanjiModeEnabled()?(v=N(s.BYTE,n.BYTE,j),q=N(s.KANJI,n.KANJI,j)):(v=N(s.BYTE_KANJI,n.BYTE,j),q=[]),E.concat(g,v,q).sort(function(m,D){return m.index-D.index}).map(function(m){return{data:m.data,mode:m.mode,length:m.length}})}function B(j,E){switch(E){case n.NUMERIC:return l.getBitsLength(j);case n.ALPHANUMERIC:return i.getBitsLength(j);case n.KANJI:return r.getBitsLength(j);case n.BYTE:return a.getBitsLength(j)}}function w(j){return j.reduce(function(E,g){const v=E.length-1>=0?E[E.length-1]:null;return v&&v.mode===g.mode?(E[E.length-1].data+=g.data,E):(E.push(g),E)},[])}function M(j){const E=[];for(let g=0;g<j.length;g++){const v=j[g];switch(v.mode){case n.NUMERIC:E.push([v,{data:v.data,mode:n.ALPHANUMERIC,length:v.length},{data:v.data,mode:n.BYTE,length:v.length}]);break;case n.ALPHANUMERIC:E.push([v,{data:v.data,mode:n.BYTE,length:v.length}]);break;case n.KANJI:E.push([v,{data:v.data,mode:n.BYTE,length:y(v.data)}]);break;case n.BYTE:E.push([{data:v.data,mode:n.BYTE,length:y(v.data)}])}}return E}function h(j,E){const g={},v={start:{}};let q=["start"];for(let o=0;o<j.length;o++){const m=j[o],D=[];for(let S=0;S<m.length;S++){const R=m[S],f=""+o+S;D.push(f),g[f]={node:R,lastCount:0},v[f]={};for(let x=0;x<q.length;x++){const C=q[x];g[C]&&g[C].node.mode===R.mode?(v[C][f]=B(g[C].lastCount+R.length,R.mode)-B(g[C].lastCount,R.mode),g[C].lastCount+=R.length):(g[C]&&(g[C].lastCount=R.length),v[C][f]=B(R.length,R.mode)+4+n.getCharCountIndicator(R.mode,E))}}q=D}for(let o=0;o<q.length;o++)v[q[o]].end=0;return{map:v,table:g}}function u(j,E){let g;const v=n.getBestModeForData(j);if(g=n.from(E,v),g!==n.BYTE&&g.bit<v.bit)throw new Error('"'+j+'" cannot be encoded with mode '+n.toString(g)+`.
 Suggested mode is: `+n.toString(v));switch(g===n.KANJI&&!d.isKanjiModeEnabled()&&(g=n.BYTE),g){case n.NUMERIC:return new l(j);case n.ALPHANUMERIC:return new i(j);case n.KANJI:return new r(j);case n.BYTE:return new a(j)}}t.fromArray=function(E){return E.reduce(function(g,v){return typeof v=="string"?g.push(u(v,null)):v.data&&g.push(u(v.data,v.mode)),g},[])},t.fromString=function(E,g){const v=p(E,d.isKanjiModeEnabled()),q=M(v),o=h(q,g),m=c.find_path(o.map,"start","end"),D=[];for(let S=1;S<m.length-1;S++)D.push(o.table[m[S]].node);return t.fromArray(w(D))},t.rawSplit=function(E){return t.fromArray(p(E,d.isKanjiModeEnabled()))}})(rt)),rt}var Ot;function ja(){if(Ot)return Oe;Ot=1;const t=he(),n=yt(),l=aa(),i=ra(),a=na(),r=ia(),s=la(),d=rs(),c=da(),y=ua(),N=ma(),p=ge(),B=ya();function w(o,m){const D=o.size,S=r.getPositions(m);for(let R=0;R<S.length;R++){const f=S[R][0],x=S[R][1];for(let C=-1;C<=7;C++)if(!(f+C<=-1||D<=f+C))for(let _=-1;_<=7;_++)x+_<=-1||D<=x+_||(C>=0&&C<=6&&(_===0||_===6)||_>=0&&_<=6&&(C===0||C===6)||C>=2&&C<=4&&_>=2&&_<=4?o.set(f+C,x+_,!0,!0):o.set(f+C,x+_,!1,!0))}}function M(o){const m=o.size;for(let D=8;D<m-8;D++){const S=D%2===0;o.set(D,6,S,!0),o.set(6,D,S,!0)}}function h(o,m){const D=a.getPositions(m);for(let S=0;S<D.length;S++){const R=D[S][0],f=D[S][1];for(let x=-2;x<=2;x++)for(let C=-2;C<=2;C++)x===-2||x===2||C===-2||C===2||x===0&&C===0?o.set(R+x,f+C,!0,!0):o.set(R+x,f+C,!1,!0)}}function u(o,m){const D=o.size,S=y.getEncodedBits(m);let R,f,x;for(let C=0;C<18;C++)R=Math.floor(C/3),f=C%3+D-8-3,x=(S>>C&1)===1,o.set(R,f,x,!0),o.set(f,R,x,!0)}function j(o,m,D){const S=o.size,R=N.getEncodedBits(m,D);let f,x;for(f=0;f<15;f++)x=(R>>f&1)===1,f<6?o.set(f,8,x,!0):f<8?o.set(f+1,8,x,!0):o.set(S-15+f,8,x,!0),f<8?o.set(8,S-f-1,x,!0):f<9?o.set(8,15-f-1+1,x,!0):o.set(8,15-f-1,x,!0);o.set(S-8,8,1,!0)}function E(o,m){const D=o.size;let S=-1,R=D-1,f=7,x=0;for(let C=D-1;C>0;C-=2)for(C===6&&C--;;){for(let _=0;_<2;_++)if(!o.isReserved(R,C-_)){let O=!1;x<m.length&&(O=(m[x]>>>f&1)===1),o.set(R,C-_,O),f--,f===-1&&(x++,f=7)}if(R+=S,R<0||D<=R){R-=S,S=-S;break}}}function g(o,m,D){const S=new l;D.forEach(function(_){S.put(_.mode.bit,4),S.put(_.getLength(),p.getCharCountIndicator(_.mode,o)),_.write(S)});const R=t.getSymbolTotalCodewords(o),f=d.getTotalCodewordsCount(o,m),x=(R-f)*8;for(S.getLengthInBits()+4<=x&&S.put(0,4);S.getLengthInBits()%8!==0;)S.putBit(0);const C=(x-S.getLengthInBits())/8;for(let _=0;_<C;_++)S.put(_%2?17:236,8);return v(S,o,m)}function v(o,m,D){const S=t.getSymbolTotalCodewords(m),R=d.getTotalCodewordsCount(m,D),f=S-R,x=d.getBlocksCount(m,D),C=S%x,_=x-C,O=Math.floor(S/x),G=Math.floor(f/x),I=G+1,X=O-G,oe=new c(X);let te=0;const F=new Array(x),W=new Array(x);let Y=0;const le=new Uint8Array(o.buffer);for(let L=0;L<x;L++){const K=L<_?G:I;F[L]=le.slice(te,te+K),W[L]=oe.encode(F[L]),te+=K,Y=Math.max(Y,K)}const Z=new Uint8Array(S);let xe=0,A,k;for(A=0;A<Y;A++)for(k=0;k<x;k++)A<F[k].length&&(Z[xe++]=F[k][A]);for(A=0;A<X;A++)for(k=0;k<x;k++)Z[xe++]=W[k][A];return Z}function q(o,m,D,S){let R;if(Array.isArray(o))R=B.fromArray(o);else if(typeof o=="string"){let O=m;if(!O){const G=B.rawSplit(o);O=y.getBestVersionForData(G,D)}R=B.fromString(o,O||40)}else throw new Error("Invalid data");const f=y.getBestVersionForData(R,D);if(!f)throw new Error("The amount of data is too big to be stored in a QR Code");if(!m)m=f;else if(m<f)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+f+`.
`);const x=g(m,D,R),C=t.getSymbolSize(m),_=new i(C);return w(_,m),M(_),h(_,m),j(_,D,0),m>=7&&u(_,m),E(_,x),isNaN(S)&&(S=s.getBestMask(_,j.bind(null,_,D))),s.applyMask(S,_),j(_,D,S),{modules:_,version:m,errorCorrectionLevel:D,maskPattern:S,segments:R}}return Oe.create=function(m,D){if(typeof m>"u"||m==="")throw new Error("No input text");let S=n.M,R,f;return typeof D<"u"&&(S=n.from(D.errorCorrectionLevel,n.M),R=y.from(D.version),f=s.from(D.maskPattern),D.toSJISFunc&&t.setToSJISFunction(D.toSJISFunc)),q(m,R,S,f)},Oe}var dt={},ut={},Jt;function ls(){return Jt||(Jt=1,(function(t){function n(l){if(typeof l=="number"&&(l=l.toString()),typeof l!="string")throw new Error("Color should be defined as hex string");let i=l.slice().replace("#","").split("");if(i.length<3||i.length===5||i.length>8)throw new Error("Invalid hex color: "+l);(i.length===3||i.length===4)&&(i=Array.prototype.concat.apply([],i.map(function(r){return[r,r]}))),i.length===6&&i.push("F","F");const a=parseInt(i.join(""),16);return{r:a>>24&255,g:a>>16&255,b:a>>8&255,a:a&255,hex:"#"+i.slice(0,6).join("")}}t.getOptions=function(i){i||(i={}),i.color||(i.color={});const a=typeof i.margin>"u"||i.margin===null||i.margin<0?4:i.margin,r=i.width&&i.width>=21?i.width:void 0,s=i.scale||4;return{width:r,scale:r?4:s,margin:a,color:{dark:n(i.color.dark||"#000000ff"),light:n(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},t.getScale=function(i,a){return a.width&&a.width>=i+a.margin*2?a.width/(i+a.margin*2):a.scale},t.getImageWidth=function(i,a){const r=t.getScale(i,a);return Math.floor((i+a.margin*2)*r)},t.qrToImageData=function(i,a,r){const s=a.modules.size,d=a.modules.data,c=t.getScale(s,r),y=Math.floor((s+r.margin*2)*c),N=r.margin*c,p=[r.color.light,r.color.dark];for(let B=0;B<y;B++)for(let w=0;w<y;w++){let M=(B*y+w)*4,h=r.color.light;if(B>=N&&w>=N&&B<y-N&&w<y-N){const u=Math.floor((B-N)/c),j=Math.floor((w-N)/c);h=p[d[u*s+j]?1:0]}i[M++]=h.r,i[M++]=h.g,i[M++]=h.b,i[M]=h.a}}})(ut)),ut}var Kt;function Na(){return Kt||(Kt=1,(function(t){const n=ls();function l(a,r,s){a.clearRect(0,0,r.width,r.height),r.style||(r.style={}),r.height=s,r.width=s,r.style.height=s+"px",r.style.width=s+"px"}function i(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(r,s,d){let c=d,y=s;typeof c>"u"&&(!s||!s.getContext)&&(c=s,s=void 0),s||(y=i()),c=n.getOptions(c);const N=n.getImageWidth(r.modules.size,c),p=y.getContext("2d"),B=p.createImageData(N,N);return n.qrToImageData(B.data,r,c),l(p,y,N),p.putImageData(B,0,0),y},t.renderToDataURL=function(r,s,d){let c=d;typeof c>"u"&&(!s||!s.getContext)&&(c=s,s=void 0),c||(c={});const y=t.render(r,s,c),N=c.type||"image/png",p=c.rendererOpts||{};return y.toDataURL(N,p.quality)}})(dt)),dt}var mt={},Yt;function va(){if(Yt)return mt;Yt=1;const t=ls();function n(a,r){const s=a.a/255,d=r+'="'+a.hex+'"';return s<1?d+" "+r+'-opacity="'+s.toFixed(2).slice(1)+'"':d}function l(a,r,s){let d=a+r;return typeof s<"u"&&(d+=" "+s),d}function i(a,r,s){let d="",c=0,y=!1,N=0;for(let p=0;p<a.length;p++){const B=Math.floor(p%r),w=Math.floor(p/r);!B&&!y&&(y=!0),a[p]?(N++,p>0&&B>0&&a[p-1]||(d+=y?l("M",B+s,.5+w+s):l("m",c,0),c=0,y=!1),B+1<r&&a[p+1]||(d+=l("h",N),N=0)):c++}return d}return mt.render=function(r,s,d){const c=t.getOptions(s),y=r.modules.size,N=r.modules.data,p=y+c.margin*2,B=c.color.light.a?"<path "+n(c.color.light,"fill")+' d="M0 0h'+p+"v"+p+'H0z"/>':"",w="<path "+n(c.color.dark,"stroke")+' d="'+i(N,y,c.margin)+'"/>',M='viewBox="0 0 '+p+" "+p+'"',u='<svg xmlns="http://www.w3.org/2000/svg" '+(c.width?'width="'+c.width+'" height="'+c.width+'" ':"")+M+' shape-rendering="crispEdges">'+B+w+`</svg>
`;return typeof d=="function"&&d(null,u),u},mt}var Gt;function ba(){if(Gt)return pe;Gt=1;const t=sa(),n=ja(),l=Na(),i=va();function a(r,s,d,c,y){const N=[].slice.call(arguments,1),p=N.length,B=typeof N[p-1]=="function";if(!B&&!t())throw new Error("Callback required as last argument");if(B){if(p<2)throw new Error("Too few arguments provided");p===2?(y=d,d=s,s=c=void 0):p===3&&(s.getContext&&typeof y>"u"?(y=c,c=void 0):(y=c,c=d,d=s,s=void 0))}else{if(p<1)throw new Error("Too few arguments provided");return p===1?(d=s,s=c=void 0):p===2&&!s.getContext&&(c=d,d=s,s=void 0),new Promise(function(w,M){try{const h=n.create(d,c);w(r(h,s,c))}catch(h){M(h)}})}try{const w=n.create(d,c);y(null,r(w,s,c))}catch(w){y(w)}}return pe.create=n.create,pe.toCanvas=a.bind(null,l.render),pe.toDataURL=a.bind(null,l.renderToDataURL),pe.toString=a.bind(null,function(r,s,d){return i.render(r,d)}),pe}var wa=ba();const Sa=cs(wa),ka={ar:{sessionManagement:"إدارة الجلسة",client:"العميل",status:"الحالة",upcoming:"قادمة",ongoing:"جارية الآن",startService:"بدء الخدمة",qrInstructions:"اطلبي من العميل مسح الكود لبدء احتساب الوقت",sessionTimeline:"جدول الجلسة",hour:"ساعة",minute:"دقيقة",safetyCheck:"الاطمئنان الدوري",noRequests:"لا توجد طلبات اطمئنان حالياً",incomingRequest:"طلب اطمئنان جديد من العميل!",confirmSafety:"تأكيد أن الطفل بخير",simulateRequest:"محاكاة طلب استلام (تجريبي)",safetyConfirmed:"تم تأكيد الاطمئنان بنجاح",contactClient:"مراسلة العميل"},en:{sessionManagement:"Session Management",client:"Client",status:"Status",upcoming:"Upcoming",ongoing:"Ongoing",startService:"Start Service",qrInstructions:"Ask client to scan code to start timer",sessionTimeline:"Session Timeline",hour:"hour",minute:"min",safetyCheck:"Safety Check",noRequests:"No active safety check requests",incomingRequest:"New Safety Check Request!",confirmSafety:"Confirm Child is Safe",simulateRequest:"Simulate Incoming Request (Demo)",safetyConfirmed:"Safety confirmed successfully",contactClient:"Contact Client"}};function Ca({language:t,booking:n,onBack:l,onChat:i}){const a=ka[t],{user:r}=ae(),[s,d]=b.useState(n),[c,y]=b.useState(!1),[N,p]=b.useState(""),[B,w]=b.useState(!0);b.useEffect(()=>{const j=async()=>{try{const E=`KHMVP-VERIFY:${s.id}:${r?.id}:${s.client_id||s.clientId}`,g=await Sa.toDataURL(E,{width:400,margin:2,color:{dark:"#FB5E7A",light:"#FFFFFF"}});p(g)}catch(E){console.error("QR code generation failed:",E)}finally{w(!1)}};s.status==="upcoming"&&j()},[s.id,s.status]),b.useEffect(()=>{const j=Q.channel(`booking-session-${s.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"bookings",filter:`id=eq.${s.id}`},g=>{const v=g.new;v.status&&(d(q=>({...q,status:v.status})),v.status==="ongoing"&&T.success(t==="ar"?"بدأت الجلسة!":"Session Started!"))}).subscribe(),E=Q.channel(`sitter-notifications-${r?.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${r?.id}`},g=>{const v=g.new;v.type==="scan_mismatch"&&(v.data?.booking_id===s.id||!v.data?.booking_id)&&T.error(t==="ar"?"هذه ليست العميلة المطلوبة!":"This is not the correct client!",{duration:5e3,style:{backgroundColor:"#fee2e2",color:"#b91c1c",border:"1px solid #fecaca"}})}).subscribe();return()=>{Q.removeChannel(j),Q.removeChannel(E)}},[s.id,t,r?.id]),b.useEffect(()=>{let j=null;return s.status==="ongoing"&&r?.id&&"geolocation"in navigator&&(j=navigator.geolocation.watchPosition(async E=>{try{await ps.updateLocation({sitter_id:r.id,booking_id:s.id,latitude:E.coords.latitude,longitude:E.coords.longitude,accuracy:E.coords.accuracy})}catch(g){console.error("Error updating location:",g)}},E=>{console.error("Geolocation error:",E)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e4})),()=>{j!==null&&navigator.geolocation.clearWatch(j)}},[s.status,s.id,r?.id]);const M=s.status==="ongoing"?50:0,h=Array.from({length:s.duration+1},(j,E)=>E),u=()=>{alert(a.safetyConfirmed),y(!1)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pb-20",children:[e.jsxs("div",{className:"p-4 flex items-center gap-4",children:[e.jsx(P,{variant:"ghost",size:"icon",onClick:l,className:"rounded-full",children:t==="ar"?e.jsx(Zt,{className:"w-6 h-6"}):e.jsx(es,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-xl font-bold",children:a.sessionManagement})]}),e.jsxs("div",{className:"p-4 max-w-md mx-auto space-y-6",children:[e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("img",{src:s.clientImage,alt:s.clientName,className:"w-14 h-14 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:s.clientName}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500 mt-1",children:[e.jsx(Ue,{className:"w-3 h-3"}),s.location]})]})]}),e.jsx(P,{size:"icon",variant:"outline",className:"rounded-full",onClick:i,children:e.jsx(ts,{className:"w-4 h-4"})})]})}),s.status==="upcoming"?e.jsxs(z,{className:"p-6 flex flex-col items-center text-center space-y-4",children:[e.jsx("h3",{className:"font-bold text-lg",children:a.startService}),e.jsx("p",{className:"text-sm text-gray-500",children:a.qrInstructions}),e.jsx("div",{className:"border-4 border-[#FB5E7A] p-2 rounded-xl bg-white inline-block relative min-w-[200px] min-h-[200px]",children:B?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(ee,{className:"w-8 h-8 animate-spin text-[#FB5E7A]"})}):N?e.jsx("img",{src:N,alt:"QR Code",className:"w-48 h-48"}):null})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(z,{className:`p-4 border-2 transition-colors ${c?"border-red-500 bg-red-50 dark:bg-red-900/20":"border-transparent"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5 text-green-600"}),a.safetyCheck]}),c&&e.jsx("span",{className:"animate-ping absolute inline-flex h-3 w-3 rounded-full bg-red-400 opacity-75 right-8"})]}),c?e.jsxs("div",{className:"space-y-4 text-center",children:[e.jsxs("div",{className:"flex flex-col items-center text-red-600 gap-2 animate-pulse",children:[e.jsx(ve,{className:"w-8 h-8"}),e.jsx("p",{className:"font-bold",children:a.incomingRequest})]}),e.jsxs(P,{className:"w-full bg-green-600 hover:bg-green-700 h-12 text-lg",onClick:u,children:[e.jsx(ys,{className:"w-5 h-5 mr-2"}),a.confirmSafety]})]}):e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-gray-500 text-sm py-2",children:a.noRequests}),e.jsxs("div",{className:"pt-8 border-t border-dashed mt-4",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2 text-center",children:t==="ar"?"(أدوات العرض التجريبي)":"(Demo Tools)"}),e.jsxs(P,{variant:"outline",size:"sm",className:"w-full border-dashed text-gray-500 hover:text-gray-700",onClick:()=>y(!0),children:[e.jsx(ve,{className:"w-3 h-3 mr-2"}),a.simulateRequest]})]})]})]}),e.jsxs(z,{className:"p-6",children:[e.jsx("h3",{className:"font-bold mb-4",children:a.sessionTimeline}),e.jsxs("div",{className:"relative pl-4 pr-4",children:[e.jsx("div",{className:"absolute left-2 top-2 bottom-2 w-0.5 bg-gray-200 rtl:right-2 rtl:left-auto"}),e.jsx("div",{className:"space-y-6",children:h.map((j,E)=>{const g=E/s.duration*100<=M;return e.jsxs("div",{className:"flex items-center gap-4 relative",children:[e.jsx("div",{className:`
                                                    w-4 h-4 rounded-full z-10 
                                                    ${g?"bg-[#FB5E7A]":"bg-gray-300"}
                                                `}),e.jsx("span",{className:g?"text-black dark:text-white font-medium":"text-gray-400",children:E===0?"Start":`${E} ${a.hour}`})]},E)})})]})]})]})]})]})}const Ea={ar:{myBookings:"إدارة الحجوزات",calendar:"التقويم",list:"القائمة",requests:"طلبات الانتظار",confirmed:"المؤكدة",ongoing:"الجارية",upcoming:"القادمة",completed:"المكتملة",date:"التاريخ",time:"الوقت",duration:"المدة",hours:"ساعات",children:"طفل",atHome:"في المنزل",outside:"خارج المنزل",contact:"تواصل",sendReport:"إرسال تقرير",noBookings:"لا توجد حجوزات في هذا القسم",egp:"جنيه",writeReport:"اكتبي تقرير الجلسة",submit:"إرسال",cancel:"إلغاء",reportSent:"تم إرسال التقرير بنجاح",recordVoice:"تسجيل صوتي",startRecording:"بدء التسجيل",stopRecording:"إيقاف التسجيل",playRecording:"تشغيل التسجيل",rating:"تقييم العميل",rateClient:"كيف كانت تجربتك مع العميل؟",or:"أو",voiceMessage:"رسالة صوتية",viewDetails:"عرض التفاصيل",pending:"قيد الانتظار",waiting_payment:"بانتظار الدفع",requestAccepted:"تم قبول الطلب بنجاح. بانتظار دفع العميلة.",requestDeclined:"تم رفض الطلب",showQR:"عرض كود QR",qrTitle:"كود تأكيد الهوية",qrDesc:"اطلبي من العميلة مسح هذا الكود عند الوصول لبدء الخدمة.",manageSession:"إدارة الجلسة",cancelled:"ملغي",error:"حدث خطأ"},en:{myBookings:"Booking Management",calendar:"Calendar",list:"List",requests:"Pending Requests",confirmed:"Confirmed",ongoing:"Ongoing",upcoming:"Upcoming",completed:"Completed",date:"Date",time:"Time",duration:"Duration",hours:"hours",children:"child",atHome:"At Home",outside:"Outside",contact:"Contact",sendReport:"Send Report",noBookings:"No bookings in this section",egp:"EGP",writeReport:"Write session report",submit:"Submit",cancel:"Cancel",reportSent:"Report sent successfully",recordVoice:"Voice Record",startRecording:"Start Recording",stopRecording:"Stop Recording",playRecording:"Play Recording",rating:"Rate Client",rateClient:"How was your experience with the client?",or:"OR",voiceMessage:"Voice Message",viewDetails:"View Details",pending:"Pending",waiting_payment:"Waiting Payment",requestAccepted:"Request accepted. Waiting for client payment.",requestDeclined:"Request declined",showQR:"Show QR Code",qrTitle:"Identity Verification Code",qrDesc:"Ask the client to scan this code upon arrival to start the service.",manageSession:"Manage Session",cancelled:"Cancelled",error:"Error occurred"}};function Aa({language:t}){const{user:n}=ae(),[l,i]=b.useState(new Date),[a,r]=b.useState(!1),[s,d]=b.useState(!1),[c,y]=b.useState(!1),[N,p]=b.useState([]),[B,w]=b.useState(!0),[M,h]=b.useState(null),[u,j]=b.useState(null),[E,g]=b.useState(null),[v,q]=b.useState(""),[o,m]=b.useState(0),[D,S]=b.useState("ongoing"),[R,f]=b.useState(!1),[x,C]=b.useState(null),[_,O]=b.useState(0),G=b.useRef(null),I=Ea[t];b.useEffect(()=>{n?.id&&X()},[n?.id]);const X=async()=>{try{if(w(!0),!n?.id)return;const A=await se.getSitterBookings(n.id);if(A){const k=A.map(L=>({id:L.id,client_id:L.client_id,clientName:L.client?.full_name||"Client",clientImage:L.client?.avatar_url||"https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=400",date:L.date,time:L.start_time,duration:L.duration_hours,location:L.location,type:L.booking_type,status:L.status,price:L.total_price,children:1,notes:""}));p(k)}}catch(A){console.error(A),T.error(I.error)}finally{w(!1)}},oe=A=>{const k=A.toISOString().split("T")[0];return N.filter(L=>L.date===k)},te=()=>{(v.trim()||x)&&o>0?(alert(I.reportSent),r(!1),q(""),C(null),m(0),j(null)):o===0&&alert(t==="ar"?"يرجى تقييم العميل":"Please rate the client")},F=async A=>{try{if(!(await U.getProfile(n.id)).is_verified){T.error(t==="ar"?"يجب توثيق حسابك أولاً لقبول الطلبات":"You must verify your account first to accept requests");return}await se.updateStatus(A,"waiting_payment"),T.success(I.requestAccepted),j(null),X()}catch{T.error(I.error)}},W=async A=>{try{await se.updateStatus(A,"cancelled"),T.success(I.requestDeclined),j(null),X()}catch{T.error(I.error)}},Y=()=>{R?(f(!1),G.current&&clearInterval(G.current),C(new Blob(["mock audio"],{type:"audio/webm"}))):(f(!0),C(null),O(0),G.current=setInterval(()=>{O(A=>A+1)},1e3))},le=A=>{const k=Math.floor(A/60),L=A%60;return`${k}:${L.toString().padStart(2,"0")}`};b.useEffect(()=>()=>{G.current&&clearInterval(G.current)},[]);const Z=A=>e.jsx(z,{className:`p-4 ${A.status==="ongoing"?"border-green-500 border-2":""}`,children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("img",{src:A.clientImage,alt:A.clientName,className:"w-16 h-16 rounded-full object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-1",children:A.clientName}),e.jsxs(V,{variant:"outline",children:[A.children," ",I.children]})]}),e.jsx(V,{className:A.status==="pending"?"bg-yellow-100 text-yellow-700":A.status==="waiting_payment"?"bg-orange-100 text-orange-700":A.status==="upcoming"?"bg-blue-100 text-blue-700":A.status==="ongoing"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700",children:A.status==="pending"?I.pending:A.status==="waiting_payment"?I.waiting_payment:I[A.status]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-600 dark:text-gray-400 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"w-4 h-4"}),e.jsx("span",{children:A.date})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{className:"w-4 h-4"}),e.jsx("span",{children:A.time})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{className:"w-4 h-4"}),e.jsxs("span",{children:[A.duration," ",I.hours]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ue,{className:"w-4 h-4"}),e.jsx("span",{children:A.location})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(V,{className:A.type==="home"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700",children:A.type==="home"?I.atHome:I.outside}),e.jsxs("div",{className:"text-[#FB5E7A]",children:[A.price," ",I.egp]})]}),e.jsx("div",{className:"flex gap-2 mt-3",children:A.status==="ongoing"||A.status==="upcoming"?e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsxs(P,{className:`flex-1 ${A.status==="ongoing"?"bg-green-600 hover:bg-green-700":"bg-[#FB5E7A] hover:bg-[#e5536e]"}`,onClick:()=>{g(A),y(!0)},children:[e.jsx(vt,{className:"w-4 h-4 mr-2"}),I.manageSession]}),e.jsx(P,{variant:"outline",onClick:()=>{h(A),d(!0)},children:e.jsx(ts,{className:"w-4 h-4"})})]}):e.jsxs(P,{className:"w-full bg-[#FB5E7A] hover:bg-[#e5536e]",onClick:()=>j(A),children:[e.jsx(pt,{className:"w-4 h-4 mr-2"}),I.viewDetails]})})]})]})},A.id),xe=()=>u?u.status==="waiting_payment"?e.jsxs(P,{size:"lg",variant:"outline",className:"w-full cursor-not-allowed opacity-70",children:[e.jsx(ne,{className:"w-5 h-5 mr-2"}),I.waiting_payment]}):e.jsx("div",{className:"flex flex-col gap-2 w-full",children:e.jsxs("div",{className:"flex gap-2",children:[(u.status==="upcoming"||u.status==="ongoing")&&e.jsx(e.Fragment,{children:e.jsxs(P,{size:"lg",className:"flex-1 bg-green-600 hover:bg-green-700",onClick:()=>{g(u),y(!0)},children:[e.jsx(vt,{className:"w-5 h-5 mr-2"}),I.manageSession]})}),u.status==="completed"&&e.jsxs(P,{size:"lg",onClick:()=>{r(!0)},className:"flex-1 bg-[#FB5E7A] hover:bg-[#e5536e]",children:[e.jsx(Te,{className:"w-5 h-5 mr-2"}),I.sendReport]})]})}):null;return s&&M?e.jsx(ta,{language:t,onBack:()=>{d(!1),h(null)},bookingId:M.id,recipientId:M.client_id,recipientName:M.clientName,recipientImage:M.clientImage}):c&&E?e.jsx(Ca,{language:t,booking:{...E,status:E.status==="upcoming"?"upcoming":"ongoing"},onBack:()=>y(!1),onChat:()=>{h(E),d(!0)}}):e.jsxs("div",{className:"max-w-4xl mx-auto px-4 pb-8",children:[u?e.jsx(as,{language:t,request:u,onBack:()=>j(null),onAccept:u.status==="pending"?()=>F(u.id):void 0,onDecline:u.status==="pending"?()=>W(u.id):void 0,customActions:u.status!=="pending"?xe():void 0}):e.jsx(e.Fragment,{children:B?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Loading..."}):e.jsxs(Ve,{defaultValue:"list",className:"space-y-4",children:[e.jsxs("div",{className:"sticky top-0 z-50 bg-gray-50 dark:bg-gray-900 pt-6 pb-2 -mx-4 px-4 mb-2 border-b border-gray-100 dark:border-gray-800",children:[e.jsx("h1",{className:"text-[#FB5E7A] text-2xl font-bold mb-4",children:I.myBookings}),e.jsxs(jt,{className:"grid w-full grid-cols-2 mb-4",children:[e.jsx(fe,{value:"list",children:I.list}),e.jsx(fe,{value:"calendar",children:I.calendar})]}),e.jsx(me,{value:"list",className:"mt-0",children:e.jsx(Ve,{value:D,onValueChange:S,className:"w-full",children:e.jsxs(jt,{className:"grid w-full grid-cols-4 h-auto bg-gray-100 dark:bg-gray-800 border-none",children:[e.jsx(fe,{value:"ongoing",className:"text-[10px] py-3 px-1 data-[state=active]:bg-[#FB5E7A] data-[state=active]:text-white",children:I.ongoing}),e.jsx(fe,{value:"requests",className:"text-[10px] py-3 px-1 data-[state=active]:bg-[#FB5E7A] data-[state=active]:text-white",children:I.requests}),e.jsx(fe,{value:"confirmed",className:"text-[10px] py-3 px-1 data-[state=active]:bg-[#FB5E7A] data-[state=active]:text-white",children:I.confirmed}),e.jsx(fe,{value:"completed",className:"text-[10px] py-3 px-1 data-[state=active]:bg-[#FB5E7A] data-[state=active]:text-white",children:I.completed})]})})})]}),e.jsx(me,{value:"list",className:"space-y-4 mt-0",children:e.jsxs(Ve,{value:D,onValueChange:S,className:"space-y-4",children:[e.jsx(me,{value:"ongoing",className:"space-y-4",children:N.filter(A=>A.status==="ongoing").length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:I.noBookings}):N.filter(A=>A.status==="ongoing").map(Z)}),e.jsx(me,{value:"requests",className:"space-y-4",children:N.filter(A=>A.status==="pending").length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:I.noBookings}):N.filter(A=>A.status==="pending").map(Z)}),e.jsx(me,{value:"confirmed",className:"space-y-4",children:N.filter(A=>A.status==="waiting_payment"||A.status==="upcoming").length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:I.noBookings}):N.filter(A=>A.status==="waiting_payment"||A.status==="upcoming").map(Z)}),e.jsx(me,{value:"completed",className:"space-y-4",children:N.filter(A=>A.status==="completed").length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:I.noBookings}):N.filter(A=>A.status==="completed").map(Z)})]})}),e.jsx(me,{value:"calendar",children:e.jsxs(z,{className:"p-6",children:[e.jsx(Qt,{mode:"single",selected:l,onSelect:A=>A&&i(A),className:"mx-auto"}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsx("h3",{className:"font-bold",children:l.toLocaleDateString(t==="ar"?"ar-EG":"en-US")}),oe(l).length===0?e.jsx("p",{className:"text-center py-8 text-gray-500",children:I.noBookings}):oe(l).map(Z)]})]})})]})}),e.jsx(Re,{open:a,onOpenChange:r,children:e.jsxs(_e,{children:[e.jsxs(qe,{children:[e.jsx(Le,{children:I.sendReport}),e.jsx(js,{children:t==="ar"?"يرجى كتابة تقرير مفصل عن الجلسة أو تسجيل رسالة صوتية.":"Please write a detailed report about the session or record a voice message."})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-2 text-center",children:[e.jsx(H,{children:I.rateClient}),e.jsx("div",{className:"flex justify-center gap-2",children:[1,2,3,4,5].map(A=>e.jsx("button",{onClick:()=>m(A),className:"focus:outline-none",children:e.jsx(xt,{className:`w-8 h-8 ${A<=o?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},A))})]}),e.jsxs("div",{className:"border-t pt-4 space-y-4",children:[e.jsx(Ae,{value:v,onChange:A=>q(A.target.value),placeholder:I.writeReport,rows:4}),e.jsx("div",{className:"text-center text-gray-500 text-sm",children:I.or}),e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(P,{variant:R?"destructive":"outline",size:"lg",onClick:Y,className:`rounded-full w-16 h-16 flex items-center justify-center ${R?"animate-pulse":""}`,children:R?e.jsx(Cs,{className:"w-8 h-8"}):e.jsx(Xt,{className:"w-8 h-8"})}),e.jsx("span",{className:"text-sm font-mono",children:R?le(_):x?I.voiceMessage:I.recordVoice})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(P,{variant:"outline",onClick:()=>r(!1),className:"flex-1",children:I.cancel}),e.jsx(P,{onClick:te,disabled:!v.trim()&&!x||o===0,className:"flex-1 bg-[#FB5E7A] hover:bg-[#e5536e]",children:I.submit})]})]})]})})]})}const De={async getTransactions(t){const{data:n,error:l}=await Q.from("transactions").select("*").eq("user_id",t).order("created_at",{ascending:!1});if(l)throw l;return n},async getBalance(t){const{data:n,error:l}=await Q.rpc("get_user_balance",{uid:t});if(l)throw l;return n},async requestWithdrawal(t,n){const{error:l}=await Q.from("transactions").insert({user_id:t,amount:n,type:"withdrawal",status:"pending",description:"Withdrawal request"});if(l)throw l},async getAllPendingWithdrawals(){const{data:t,error:n}=await Q.from("transactions").select(`
                *,
                profiles:user_id (
                    full_name,
                    phone
                )
            `).eq("type","withdrawal").eq("status","pending").order("created_at",{ascending:!1});if(n)throw n;return t},async updateTransactionStatus(t,n){const{error:l}=await Q.from("transactions").update({status:n}).eq("id",t);if(l)throw l}},Ba={ar:{earnings:"أرباحي",totalBalance:"الرصيد الكلي",thisMonth:"هذا الشهر",lastMonth:"الشهر الماضي",withdraw:"سحب الأموال",history:"سجل المعاملات",earning:"إيداع",withdrawal:"سحب",completed:"مكتمل",pending:"قيد المعالجة",failed:"فشل",egp:"جنيه",date:"التاريخ",amount:"المبلغ",status:"الحالة",noTransactions:"لا توجد معاملات",stats:"الإحصائيات",totalEarnings:"إجمالي الأرباح",totalWithdrawals:"إجمالي السحوبات",availableBalance:"الرصيد المتاح",downloadReport:"تحميل التقرير",jobPayment:"دفعة عن جلسة",withdrawalTo:"سحب إلى",confirmWithdrawal:"تأكيد السحب",enterAmount:"أدخل المبلغ المراد سحبه",insufficientBalance:"رصيد غير كافي",successWithdrawal:"تم تقديم طلب السحب بنجاح"},en:{earnings:"Earnings",totalBalance:"Total Balance",thisMonth:"This Month",lastMonth:"Last Month",withdraw:"Withdraw",history:"Transaction History",earning:"Earning",withdrawal:"Withdrawal",completed:"Completed",pending:"Pending",failed:"Failed",egp:"EGP",date:"Date",amount:"Amount",status:"Status",noTransactions:"No transactions",stats:"Statistics",totalEarnings:"Total Earnings",totalWithdrawals:"Total Withdrawals",availableBalance:"Available Balance",downloadReport:"Download Report",jobPayment:"Payment for job",withdrawalTo:"Withdrawal to",confirmWithdrawal:"Confirm Withdrawal",enterAmount:"Enter amount to withdraw",insufficientBalance:"Insufficient balance",successWithdrawal:"Withdrawal request submitted successfully"}};function Da({language:t}){const n=Ba[t],{user:l}=ae(),[i,a]=b.useState([]),[r,s]=b.useState(0),[d,c]=b.useState(!1),[y,N]=b.useState(!1);b.useEffect(()=>{l?.id&&p()},[l?.id]);const p=async()=>{try{if(!l?.id)return;c(!0);const[g,v]=await Promise.all([De.getTransactions(l.id),De.getBalance(l.id)]);a(g),s(v)}catch(g){console.error(g),T.error("Failed to load wallet data")}finally{c(!1)}},B=async()=>{const g=prompt(n.enterAmount);if(!g)return;const v=parseFloat(g);if(!(isNaN(v)||v<=0)){if(v>r){T.error(n.insufficientBalance);return}try{if(!l?.id)return;N(!0),await De.requestWithdrawal(l.id,v),T.success(n.successWithdrawal),p()}catch(q){console.error(q),T.error("Withdrawal failed")}finally{N(!1)}}},M=new Date().getMonth(),h=M===0?11:M-1,u=i.filter(g=>g.type==="earning"&&g.status==="completed"&&new Date(g.created_at).getMonth()===M).reduce((g,v)=>g+Number(v.amount),0),j=i.filter(g=>g.type==="earning"&&g.status==="completed"&&new Date(g.created_at).getMonth()===h).reduce((g,v)=>g+Number(v.amount),0),E=i.filter(g=>g.type==="withdrawal"&&g.status!=="failed").reduce((g,v)=>g+Number(v.amount),0);return e.jsxs("div",{className:"max-w-4xl mx-auto px-4 pb-8",children:[e.jsx("div",{className:"sticky top-0 z-50 bg-gray-50 dark:bg-gray-900 pt-6 pb-4 -mx-4 px-4 mb-4 border-b border-gray-100 dark:border-gray-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-[#FB5E7A] text-2xl font-bold",children:n.earnings}),e.jsxs(P,{className:"bg-[#FB5E7A] hover:bg-[#e5536e]",onClick:B,disabled:y||r<=0,children:[y?e.jsx(ee,{className:"animate-spin"}):e.jsx(Ie,{className:"w-4 h-4 mr-2"}),n.withdraw]})]})}),e.jsxs(z,{className:"p-6 mb-6 bg-gradient-to-br from-[#FB5E7A] to-[#e5536e] text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/80 mb-1",children:n.availableBalance}),e.jsxs("h1",{className:"text-white text-4xl",children:[r," ",n.egp]})]}),e.jsx("div",{className:"w-16 h-16 rounded-full bg-white/20 flex items-center justify-center",children:e.jsx(ft,{className:"w-8 h-8"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-white/20",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/80 text-sm mb-1",children:n.thisMonth}),e.jsxs("p",{className:"text-xl",children:[u," ",n.egp]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/80 text-sm mb-1",children:n.lastMonth}),e.jsxs("p",{className:"text-xl",children:[j," ",n.egp]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:n.totalEarnings}),e.jsxs("h3",{className:"text-green-600",children:["+",u," ",n.egp]})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center",children:e.jsx(gt,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:n.totalWithdrawals}),e.jsxs("h3",{className:"text-red-600",children:["-",E," ",n.egp]})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center",children:e.jsx(Ie,{className:"w-6 h-6 text-red-600"})})]})})]}),e.jsxs(z,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{children:n.history}),e.jsxs(P,{variant:"ghost",size:"sm",children:[e.jsx(_s,{className:"w-4 h-4 mr-2"}),n.downloadReport]})]}),d?e.jsx("div",{className:"text-center py-12",children:e.jsx(ee,{className:"w-8 h-8 mx-auto animate-spin text-gray-400"})}):i.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:n.noTransactions}):e.jsx("div",{className:"space-y-3",children:i.map(g=>e.jsxs("div",{className:"flex items-center justify-between p-3 border-b last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${g.type==="earning"?"bg-green-100 dark:bg-green-900":"bg-red-100 dark:bg-red-900"}`,children:g.type==="earning"?e.jsx(gt,{className:"w-5 h-5 text-green-600"}):e.jsx(Ie,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm mb-1",children:g.description}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(ie,{className:"w-3 h-3"}),e.jsx("span",{children:new Date(g.created_at).toLocaleDateString()})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`mb-1 ${g.type==="earning"?"text-green-600":"text-red-600"}`,children:[g.type==="earning"?"+":"-",g.amount," ",n.egp]}),e.jsx(V,{className:g.status==="completed"?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300":g.status==="pending"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300":"bg-red-100 text-red-700",children:n[g.status]})]})]},g.id))})]})]})}const Ra={ar:{profile:"الملف الشخصي",personalInfo:"المعلومات الشخصية",verification:"التوثيق",availability:"الأوقات المتاحة",availabilitySettings:"إعدادات التوفر",atHomeOnly:"متاحة في المنزل فقط",outsideOnly:"متاحة خارج المنزل فقط",both:"متاحة في المنزل وخارج المنزل",skills:"المهارات",photos:"الصور",services:"الخدمات",myServices:"خدماتي",fullName:"الاسم الكامل",email:"البريد الإلكتروني",phone:"رقم الهاتف",location:"الموقع",bio:"نبذة عني",experience:"سنوات الخبرة",edit:"تعديل",save:"حفظ",cancel:"إلغاء",verified:"موثق",notVerified:"غير موثق",idCard:"بطاقة الهوية",introVideo:"فيديو تعريفي",certificates:"الشهادات",uploadIdCard:"رفع بطاقة الهوية",uploadVideo:"رفع فيديو",uploadCertificate:"رفع شهادة",addSkill:"إضافة مهارة",skillName:"اسم المهارة",addPhoto:"إضافة صورة",logout:"تسجيل خروج",memberSince:"عضو منذ",rating:"التقييم",reviews:"تقييم",completedJobs:"جلسة مكتملة",egp:"جنيه",delete:"حذف",languages:"اللغات",addLanguage:"إضافة لغة",language:"اللغة",stats:"الإحصائيات",verificationStatus:"حالة التوثيق",pending:"قيد المراجعة",approved:"موثق",rejected:"مرفوض",theme:"المظهر",lightMode:"الوضع النهاري",darkMode:"الوضع الليلي",serviceOutside:"مرافقة خارج المنزل",serviceWeekly:"جلسات اسبوعية",serviceMonthly:"جلسات شهرية",setPrice:"تحديد سعر الساعة",minPriceError:"سعر الساعة لا يجب أن يقل عن 30 جنيه",homeServices:"خدمات منزلية",outsideServices:"خدمات خارجية",contactSupport:"تواصل مع الدعم",success:"تمت العملية بنجاح",error:"حدث خطأ ما",visibilitySettings:"إعدادات الظهور",visibilityDesc:"عند تعطيل هذه الخاصية، لن تظهري للعملاء في نتائج البحث، ولكن ستظلين قادرة على إكمال طلباتك الحالية.",activeStatus:"الحساب نشط الآن",inactiveStatus:"الحساب متوقف حالياً"},en:{profile:"Profile",personalInfo:"Personal Information",verification:"Verification",availability:"Availability",availabilitySettings:"Availability Settings",atHomeOnly:"Available at home only",outsideOnly:"Available outside only",both:"Available at home and outside",skills:"Skills",photos:"Photos",services:"Services",myServices:"My Services",fullName:"Full Name",email:"Email",phone:"Phone Number",location:"Location",bio:"About Me",experience:"Years of Experience",edit:"Edit",save:"Save",cancel:"Cancel",verified:"Verified",notVerified:"Not Verified",idCard:"ID Card",introVideo:"Intro Video",certificates:"Certificates",uploadIdCard:"Upload ID Card",uploadVideo:"Upload Video",uploadCertificate:"Upload Certificate",addSkill:"Add Skill",skillName:"Skill Name",addPhoto:"Add Photo",logout:"Logout",memberSince:"Member Since",rating:"Rating",reviews:"reviews",completedJobs:"completed jobs",egp:"EGP",delete:"Delete",languages:"Languages",addLanguage:"Add Language",language:"Language",stats:"Statistics",verificationStatus:"Verification Status",pending:"Pending Review",approved:"Verified",rejected:"Rejected",theme:"Theme",lightMode:"Light Mode",darkMode:"Dark Mode",serviceOutside:"Accompaniment Outside Home",serviceWeekly:"Weekly Sessions",serviceMonthly:"Monthly Sessions",themeLight:"Light Mode",themeDark:"Dark Mode",setPrice:"Set Hourly Rate",minPriceError:"Hourly rate must be at least 30 EGP",homeServices:"Home Services",outsideServices:"Outside Services",contactSupport:"Contact Support",success:"Operation Successful",error:"Something went wrong",visibilitySettings:"Visibility Settings",visibilityDesc:"When disabled, you will not appear in client search results, but you can still complete your ongoing bookings.",activeStatus:"Account is Active",inactiveStatus:"Account is Paused"}};function _a({language:t,onLogout:n,onLanguageChange:l,theme:i,onThemeChange:a,onBack:r}){const{user:s}=ae(),[d,c]=b.useState(!1),[y,N]=b.useState(!1),[p,B]=b.useState(!1),[w,M]=b.useState(!1),h=Ra[t],[u,j]=b.useState({name:s?.user_metadata?.full_name||"",email:s?.email||"",phone:s?.user_metadata?.phone||"",location:"",bio:"",experience:0,rating:5,reviews:0,completedJobs:0,memberSince:"",isVerified:!1,avatarUrl:""}),[E,g]=b.useState(!0),[v,q]=b.useState([]),[o,m]=b.useState([]),[D,S]=b.useState(""),[R,f]=b.useState(""),[x,C]=b.useState("both"),[_,O]=b.useState(!0),[G,I]=b.useState(!1);b.useEffect(()=>{if(s?.id){oe(),te(),X();const k=Q.channel(`profile-updates-${s.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"profiles",filter:`id=eq.${s.id}`},L=>{const K=L.new;K.is_verified!==void 0&&(j(ue=>({...ue,isVerified:K.is_verified})),K.is_verified&&T.success(t==="ar"?"تم توثيق حسابك بنجاح!":"Your account has been verified!"))}).subscribe();return()=>{Q.removeChannel(k)}}},[s?.id]);const X=async()=>{try{if(!s?.id)return;const{average:k,count:L}=await Es.getSitterAverageRating(s.id);j(K=>({...K,rating:L>0?k:5,reviews:L}))}catch(k){console.error(k)}},oe=async()=>{try{if(g(!0),!s?.id)return;const k=await U.getProfile(s.id),K=(await se.getSitterBookings(s.id)).filter(ue=>ue.status==="completed").length;k&&(j(ue=>({...ue,name:k.full_name||s?.user_metadata?.full_name||"",email:s?.email||"",phone:k.phone||s?.user_metadata?.phone||"",location:k.location||"",bio:k.bio||"",experience:k.experience_years||0,isVerified:k.is_verified||!1,memberSince:k.created_at?new Date(k.created_at).toLocaleDateString():"",completedJobs:K,avatarUrl:k.avatar_url||"https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=400"})),k.availability_type&&C(k.availability_type),O(k.is_active??!0))}catch{console.error("Error loading profile"),T.error(h.error)}finally{g(!1)}},te=async()=>{try{if(!s?.id)return;const[k,L]=await Promise.all([U.getSkills(s.id),U.getLanguages(s.id)]);k&&q(k.map(K=>({id:K.id,skill:K.skill}))),L&&m(L.map(K=>({id:K.id,language:K.language})))}catch(k){console.error(k)}},F=async k=>{const L=k.target.files?.[0];if(!(!L||!s?.id)){if(L.size>5*1024*1024){T.error(t==="ar"?"حجم الصورة يجب أن لا يتعدى 5 ميجابايت":"Image size must be less than 5MB");return}if(!["image/jpeg","image/png","image/webp"].includes(L.type)){T.error(t==="ar"?"يجب أن تكون الصورة بصيغة JPG, PNG أو WebP":"Image must be JPG, PNG or WebP");return}try{M(!0);const K=await U.updateAvatar(s.id,L);j(ue=>({...ue,avatarUrl:K})),T.success(h.success)}catch(K){console.error(K),T.error(h.error)}finally{M(!1)}}},W=async()=>{try{if(!s?.id)return;await U.updateProfile(s.id,{full_name:u.name,phone:u.phone,location:u.location,bio:u.bio,experience_years:u.experience,availability_type:x,is_active:_}),c(!1),T.success(h.success)}catch(k){console.error(k),T.error(h.error)}},Y=async()=>{if(!(!s?.id||G))try{I(!0);const k=!_;await U.updateProfile(s.id,{is_active:k}),O(k),T.success(h.success)}catch(k){console.error(k),T.error(h.error)}finally{I(!1)}},le=async()=>{if(D.trim()&&s?.id)try{await U.addSkill(s.id,D),S(""),N(!1),await te(),T.success(h.success)}catch{T.error(h.error)}},Z=async k=>{try{await U.removeSkill(k),q(v.filter(L=>L.id!==k))}catch{T.error(h.error)}},xe=async()=>{if(R.trim()&&s?.id)try{await U.addLanguage(s.id,R),f(""),B(!1),await te(),T.success(h.success)}catch{T.error(h.error)}},A=async k=>{try{await U.removeLanguage(k),m(o.filter(L=>L.id!==k)),T.success(h.success)}catch{T.error(h.error)}};return E?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(ee,{className:"w-8 h-8 animate-spin text-[#FB5E7A]"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pb-20",children:[e.jsx("div",{className:"sticky top-0 z-50 bg-gray-50 dark:bg-gray-900 pt-6 pb-4 -mx-4 px-8 mb-4 border-b border-gray-100 dark:border-gray-800",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(P,{variant:"ghost",size:"icon",onClick:r,className:"rounded-full",children:t==="ar"?e.jsx(Zt,{className:"w-6 h-6"}):e.jsx(es,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-[#FB5E7A] text-2xl font-bold",children:h.profile})]})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[e.jsxs(z,{className:"p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:`w-20 h-20 rounded-full bg-[#FFD1DA] flex items-center justify-center overflow-hidden border-2 border-transparent group-hover:border-[#FB5E7A] transition-all cursor-pointer ${w?"opacity-50":""}`,onClick:()=>document.getElementById("avatar-input")?.click(),children:[e.jsx("img",{src:u.avatarUrl,alt:u.name,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx($t,{className:"w-6 h-6 text-white"})}),w&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(ee,{className:"w-6 h-6 animate-spin text-[#FB5E7A]"})})]}),e.jsx("input",{id:"avatar-input",type:"file",accept:"image/*",className:"hidden",onChange:F,disabled:w}),e.jsx("p",{className:"text-[10px] text-gray-500 text-center mt-2 w-24 mx-auto",children:t==="ar"?"JPG, PNG - بحد أقصى 5 ميجا":"JPG, PNG - Max 5MB"}),u.isVerified&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center ring-2 ring-white dark:ring-gray-800",children:e.jsx($,{className:"w-4 h-4 text-white"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-[#FB5E7A] mb-1",children:u.name}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:[h.memberSince," ",u.memberSince]}),u.isVerified&&e.jsxs(V,{className:"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300",children:[e.jsx(ze,{className:"w-3 h-3 mr-1"}),h.verified]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 text-[#FB5E7A] mb-1",children:[e.jsx(xt,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:u.rating})]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[u.reviews," ",h.reviews]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-[#FB5E7A] mb-1",children:u.completedJobs}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:h.completedJobs})]})]})]}),e.jsxs(z,{className:"p-6 mb-6 border-2 transition-all duration-300 bg-white dark:bg-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pt,{className:"w-5 h-5 text-[#FB5E7A]"}),e.jsx("h3",{className:"font-bold",children:h.visibilitySettings})]}),e.jsxs(P,{variant:_?"default":"outline",className:_?"bg-green-600 hover:bg-green-700":"border-red-500 text-red-500 cursor-pointer",onClick:Y,disabled:G,children:[G?e.jsx(ee,{className:"w-4 h-4 animate-spin mr-2"}):_?e.jsx($,{className:"w-4 h-4 mr-2"}):e.jsx(Nt,{className:"w-4 h-4 mr-2"}),_?h.activeStatus:h.inactiveStatus]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:h.visibilityDesc})]}),e.jsxs(z,{className:"p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{children:h.personalInfo}),!d&&e.jsxs(P,{variant:"ghost",size:"sm",onClick:()=>c(!0),className:"text-[#FB5E7A]",children:[e.jsx(Ns,{className:"w-4 h-4 mr-2"}),h.edit]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{children:h.fullName}),e.jsx(J,{value:u.name,onChange:k=>j({...u,name:k.target.value}),disabled:!0,className:"bg-gray-50 cursor-not-allowed"}),d&&e.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:t==="ar"?"* لا يمكن تغيير الاسم":"* Name cannot be changed"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{children:h.email}),e.jsx(J,{value:u.email,onChange:k=>j({...u,email:k.target.value}),disabled:!0,className:"bg-gray-50 cursor-not-allowed"}),d&&e.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:t==="ar"?"* لا يمكن تغيير البريد الإلكتروني":"* Email cannot be changed"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{children:h.phone}),e.jsx(J,{value:u.phone,onChange:k=>j({...u,phone:k.target.value}),disabled:!d})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{children:h.location}),e.jsx(J,{value:u.location,onChange:k=>j({...u,location:k.target.value}),disabled:!d})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{children:h.bio}),e.jsx(Ae,{value:u.bio,onChange:k=>j({...u,bio:k.target.value}),disabled:!d,rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{children:h.experience}),e.jsx(J,{type:"number",value:u.experience,onChange:k=>j({...u,experience:parseInt(k.target.value)||0}),disabled:!d})]}),d&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{onClick:W,className:"flex-1 bg-[#FB5E7A]",children:h.save}),e.jsx(P,{variant:"outline",onClick:()=>c(!1),className:"flex-1",children:h.cancel})]})]})]}),e.jsxs(z,{className:"p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{children:h.availabilitySettings}),e.jsx(P,{onClick:W,size:"sm",className:"bg-[#FB5E7A]",children:h.save})]}),e.jsx("div",{className:"space-y-3",children:["home","outside","both"].map(k=>e.jsxs("div",{onClick:()=>C(k),className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${x===k?"border-[#FB5E7A] bg-[#FFD1DA]/20":"border-gray-200 dark:border-gray-700"}`,children:[e.jsx("h4",{className:"mb-1",children:h[`${k}Only`]||h.both}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t==="ar"?"سأكون متاحة للعمل حسب الاختيار":"I will be available based on this choice"})]},k))})]}),e.jsxs(z,{className:"p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{children:h.skills}),e.jsxs(P,{variant:"ghost",size:"sm",onClick:()=>N(!0),className:"text-[#FB5E7A]",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),h.addSkill]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:v.map(k=>e.jsxs(V,{className:"bg-[#FFD1DA] text-[#FB5E7A] pr-1",children:[k.skill,e.jsx("button",{onClick:()=>Z(k.id),className:"ml-2 hover:text-red-500",children:e.jsx(be,{className:"w-3 h-3"})})]},k.id))})]}),e.jsxs(z,{className:"p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{children:h.languages}),e.jsxs(P,{variant:"ghost",size:"sm",onClick:()=>B(!0),className:"text-[#FB5E7A]",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),h.addLanguage]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:o.map(k=>e.jsxs(V,{className:"bg-[#E5E7EB] text-gray-700 pr-1",children:[k.language,e.jsx("button",{onClick:()=>A(k.id),className:"ml-2 hover:text-red-500",children:e.jsx(be,{className:"w-3 h-3"})})]},k.id))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(P,{variant:"outline",className:"w-full h-12 flex justify-between px-6 border-[#FB5E7A] text-[#FB5E7A]",onClick:l,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(vs,{className:"w-5 h-5"}),e.jsx("span",{children:h.language})]}),e.jsx("span",{children:t==="ar"?"🇬🇧 EN":"🇪🇬 AR"})]}),e.jsxs(P,{variant:"outline",className:"w-full h-12 flex justify-between px-6 border-[#FB5E7A] text-[#FB5E7A]",onClick:a,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[i==="light"?e.jsx(Nt,{className:"w-5 h-5"}):e.jsx(bs,{className:"w-5 h-5"}),e.jsx("span",{children:h.theme})]}),e.jsx("span",{children:i==="light"?h.darkMode:h.lightMode})]}),e.jsxs(P,{variant:"outline",className:"w-full h-12 border-red-500 text-red-500 hover:bg-red-50",onClick:n,children:[e.jsx(ws,{className:"w-5 h-5 mr-3"}),h.logout]})]})]}),e.jsx(Re,{open:y,onOpenChange:N,children:e.jsxs(_e,{children:[e.jsx(qe,{children:e.jsx(Le,{children:h.addSkill})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(J,{value:D,onChange:k=>S(k.target.value),placeholder:h.skillName}),e.jsx(P,{onClick:le,className:"w-full bg-[#FB5E7A]",children:h.addSkill})]})]})}),e.jsx(Re,{open:p,onOpenChange:B,children:e.jsxs(_e,{children:[e.jsx(qe,{children:e.jsx(Le,{children:h.addLanguage})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(J,{value:R,onChange:k=>f(k.target.value),placeholder:h.language}),e.jsx(P,{onClick:xe,className:"w-full bg-[#FB5E7A]",children:h.addLanguage})]})]})})]})}const Pa={ar:{title:"إدارة طلبات السحب",noRequests:"لا توجد طلبات سحب معلقة",sitter:"الخالة",amount:"المبلغ",date:"التاريخ",actions:"الإجراءات",approve:"قبول",reject:"رفض",confirmApprove:"هل أنت متأكد من قبول عملية السحب؟",confirmReject:"هل أنت متأكد من رفض عملية السحب؟",successApprove:"تم قبول السحب بنجاح",successReject:"تم رفض السحب",egp:"جنيه",pending:"معلق"},en:{title:"Withdrawal Management",noRequests:"No pending withdrawal requests",sitter:"Sitter",amount:"Amount",date:"Date",actions:"Actions",approve:"Approve",reject:"Reject",confirmApprove:"Are you sure you want to approve this withdrawal?",confirmReject:"Are you sure you want to reject this withdrawal?",successApprove:"Withdrawal approved successfully",successReject:"Withdrawal rejected",egp:"EGP",pending:"Pending"}};function Ma({language:t}){const n=Pa[t],[l,i]=b.useState([]),[a,r]=b.useState(!0),[s,d]=b.useState(null);b.useEffect(()=>{c()},[]);const c=async()=>{try{r(!0);const N=await De.getAllPendingWithdrawals();i(N)}catch(N){console.error("Error loading withdrawals:",N),T.error("Failed to load withdrawal requests")}finally{r(!1)}},y=async(N,p)=>{const B=p==="completed"?n.confirmApprove:n.confirmReject;if(confirm(B))try{d(N),await De.updateTransactionStatus(N,p),T.success(p==="completed"?n.successApprove:n.successReject),c()}catch(w){console.error("Error processing withdrawal:",w),T.error("Failed to process withdrawal")}finally{d(null)}};return a?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(ee,{className:"w-8 h-8 animate-spin text-[#FB5E7A]"})}):e.jsxs("div",{className:"max-w-6xl mx-auto p-4",children:[e.jsx("div",{className:"sticky top-0 z-50 bg-gray-50 dark:bg-gray-900 pt-6 pb-4 -mx-4 px-4 mb-4 border-b border-gray-100 dark:border-gray-800",children:e.jsx("h1",{className:"text-[#FB5E7A] text-2xl font-bold",children:n.title})}),l.length===0?e.jsxs(z,{className:"p-12 text-center text-gray-500",children:[e.jsx(ft,{className:"w-12 h-12 mx-auto mb-4 opacity-20"}),e.jsx("p",{children:n.noRequests})]}):e.jsx("div",{className:"grid gap-4",children:l.map(N=>e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-[#FB5E7A]/10 flex items-center justify-center",children:e.jsx(He,{className:"w-6 h-6 text-[#FB5E7A]"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:N.profiles?.full_name||"Unknown Sitter"}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ss,{className:"w-3 h-3"}),N.profiles?.phone||"N/A"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"w-3 h-3"}),new Date(N.created_at).toLocaleDateString()]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:n.amount}),e.jsxs("p",{className:"text-xl font-bold text-[#FB5E7A]",children:[N.amount," ",n.egp]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>y(N.id,"completed"),disabled:!!s,children:[s===N.id?e.jsx(ee,{className:"w-4 h-4 animate-spin"}):e.jsx($,{className:"w-4 h-4 mr-1"}),n.approve]}),e.jsxs(P,{size:"sm",variant:"outline",className:"text-red-600 border-red-200 hover:bg-red-50",onClick:()=>y(N.id,"failed"),disabled:!!s,children:[e.jsx(Pe,{className:"w-4 h-4 mr-1"}),n.reject]})]})]})]})},N.id))})]})}const Fa={ar:{home:"الرئيسية",bookings:"الحجوزات",earnings:"الأرباح",profile:"الملف الشخصي",admin:"الإدارة"},en:{home:"Home",bookings:"Bookings",earnings:"Earnings",profile:"Profile",admin:"Admin"}};function za({language:t,onLogout:n,onLanguageChange:l,theme:i,onThemeChange:a}){const[r,s]=b.useState("home"),{user:d}=ae(),c=d?.user_metadata?.role==="admin"||d?.user_metadata?.role==="khala",y=Fa[t];return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pb-20",children:[e.jsxs("div",{className:"pt-4",children:[r==="home"&&e.jsx(Zs,{language:t}),r==="bookings"&&e.jsx(Aa,{language:t}),r==="earnings"&&e.jsx(Da,{language:t}),r==="profile"&&e.jsx(_a,{language:t,onLogout:n,onLanguageChange:l,theme:i,onThemeChange:a}),r==="admin"&&e.jsx(Ma,{language:t})]}),e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 px-2 py-3",children:e.jsxs("div",{className:"max-w-lg mx-auto flex justify-between items-center px-2",children:[e.jsxs("button",{onClick:()=>s("home"),className:`flex flex-col items-center gap-1 flex-1 ${r==="home"?"text-[#FB5E7A]":"text-gray-500"}`,children:[e.jsx(ks,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[10px]",children:y.home})]}),e.jsxs("button",{onClick:()=>s("bookings"),className:`flex flex-col items-center gap-1 flex-1 ${r==="bookings"?"text-[#FB5E7A]":"text-gray-500"}`,children:[e.jsx(ie,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[10px]",children:y.bookings})]}),e.jsxs("button",{onClick:()=>s("earnings"),className:`flex flex-col items-center gap-1 flex-1 ${r==="earnings"?"text-[#FB5E7A]":"text-gray-500"}`,children:[e.jsx(ft,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[10px]",children:y.earnings})]}),c&&e.jsxs("button",{onClick:()=>s("admin"),className:`flex flex-col items-center gap-1 flex-1 ${r==="admin"?"text-[#FB5E7A]":"text-gray-500"}`,children:[e.jsx(ze,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[10px]",children:y.admin})]}),e.jsxs("button",{onClick:()=>s("profile"),className:`flex flex-col items-center gap-1 flex-1 ${r==="profile"?"text-[#FB5E7A]":"text-gray-500"}`,children:[e.jsx(He,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[10px]",children:y.profile})]})]})})]})}export{za as default};
